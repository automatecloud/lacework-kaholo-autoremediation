{
    "configurations": [
        {
            "_id": "605330d4887b2000349afecb",
            "name": "LaceworkConfig",
            "value": "{\n    \"name\": \"LaceworkConfiguration\",\n    \"policyID\": \"LW_S3_18\",\n    \"violationdescription\": \"Ensure the attached S3 bucket policy does not grant global Get permission.\",\n    \"eventuuid\": \"2d8ddf58-df9b-4ea7-ad64-356e6176c6bd\",\n    \"dothedeletebucketpolicyremediationviacli\": \"false\",\n    \"dothedeletebucketpolicyremediationviaobject\": \"false\",\n    \"dothereplacebucketpolicyremediationviacli\": \"false\",\n    \"dothereplacebucketpolicyremediationviaobject\": \"false\",\n    \"sendslackmessagesforignored\": \"true\",\n    \"bucketIgnoreList\": [\n        \"arn:aws:s3:::mybucket01\",\n        \"arn:aws:s3:::mybucket02\",\n        \"arn:aws:s3:::mybucket03\"\n    ],\n    \"createbackup\": \"true\",\n    \"inputfolder\": \"/usr/src/app/scripts/input/\",\n    \"backupfolder\": \"/usr/src/app/scripts/output/\",\n    \"bucketpolicy\": {\n        \"Statement\": [\n            {\n                \"Action\": \"s3:*\",\n                \"Effect\": \"Allow\",\n                \"Resource\": \"<MYBUCKET>\", \n                \"Principal\": {\n                    \"AWS\": [\n                        \"arn:aws:iam::ACCOUNTID:user/OWNER\"\n                    ]\n                }\n            }\n        ]\n    }\n}",
            "mapRevision": "605330d4887b2000349afe91",
            "__v": 0
        }
    ],
    "processes": [
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "6050b655887b20003494e3eb",
                            "code": true,
                            "value": "geteventid()",
                            "param": "6036a2ec07d26400341da690",
                            "name": "EVENT_ID"
                        }
                    ],
                    "name": "geteventid",
                    "timeout": null,
                    "method": "GetEventDetails",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "lacework",
                "version": "1.0.0"
            },
            "uuid": "2d8ddf58-df9b-4ea7-ad64-356e6176c6bd",
            "numProcessParallel": null,
            "name": "Get event details",
            "description": null,
            "condition": "checkconfiguration()",
            "coordination": null,
            "filterAgents": null,
            "postRun": "createBucketList() ",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "605330d4887b2000349afe97",
                            "code": true,
                            "value": "printBucketName()",
                            "param": "6050b655887b20003494e3ee",
                            "name": "COMMANDS"
                        }
                    ],
                    "name": "printBucketName",
                    "timeout": null,
                    "method": "execute",
                    "numParallel": null
                },
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "605330d4887b2000349afe99",
                            "code": true,
                            "value": "createbackup()",
                            "param": null,
                            "name": "COMMANDS"
                        }
                    ],
                    "name": "createbackup",
                    "timeout": null,
                    "method": "execute",
                    "numParallel": null
                },
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "605330d4887b2000349afe9b",
                            "code": true,
                            "value": "deleteviaawscli()",
                            "param": "6050b655887b20003494e3f0",
                            "name": "COMMANDS"
                        }
                    ],
                    "name": "deleteviaawscli",
                    "timeout": null,
                    "method": "execute",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "CommandLine",
                "version": "1.2.0"
            },
            "uuid": "31d9c5ff-ee5b-4a49-b810-ac7dea2377e5",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Delete Bucket Policy via CLI",
            "description": "S3 buckets to remediate\n",
            "condition": "checkdeleteremediationviacli()",
            "filterAgents": null,
            "postRun": "indexRemediate++;",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "6050b655887b20003494e3f3",
                            "code": null,
                            "value": "Slack Webhook",
                            "param": null,
                            "name": "webhookUrl"
                        },
                        {
                            "_id": "6050b655887b20003494e3f4",
                            "code": true,
                            "value": "sendslackmessage()",
                            "param": null,
                            "name": "message"
                        }
                    ],
                    "name": "informsecurity",
                    "timeout": null,
                    "method": "sendIncomingWebhook",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Slack",
                "version": "1.1.0"
            },
            "uuid": "335c4aa0-b21b-419c-8235-79cfd5bc57dd",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Remediated",
            "description": null,
            "condition": "indexSlack < bucketArr.length",
            "filterAgents": null,
            "postRun": "indexSlack++;",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "name": "printBucketName",
                    "timeout": null,
                    "retries": 0,
                    "method": "execute",
                    "mandatory": null,
                    "params": [
                        {
                            "code": true,
                            "value": "printBucketName()",
                            "param": "605330d4887b2000349afea2",
                            "viewName": "command",
                            "name": "COMMANDS",
                            "type": "string",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                },
                {
                    "name": "createbackup",
                    "timeout": null,
                    "retries": 0,
                    "method": "execute",
                    "mandatory": null,
                    "params": [
                        {
                            "code": true,
                            "value": "createbackup()",
                            "param": "605330d4887b2000349afea4",
                            "viewName": "command",
                            "name": "COMMANDS",
                            "type": "string",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "CommandLine",
                "version": "1.2.0"
            },
            "uuid": "d6566c62-481d-40e2-b823-ba8c9fa9f31c",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Create Backup via CLI",
            "description": "S3 buckets to remediate\n",
            "condition": "checkreplaceremediationviacli()",
            "filterAgents": null,
            "postRun": "indexRemediate++;",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "name": "listbucketpolicy",
                    "timeout": null,
                    "retries": 0,
                    "method": "getBucketPolicy",
                    "mandatory": null,
                    "params": [
                        {
                            "code": null,
                            "value": "AWS Access Key",
                            "param": null,
                            "viewName": "Access key",
                            "name": "AWS_ACCESS_KEY_ID",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": null,
                            "value": "AWS Secret Key",
                            "param": null,
                            "viewName": "Secret key",
                            "name": "AWS_SECRET_ACCESS_KEY",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getbucketname()",
                            "param": null,
                            "viewName": "Bucket name",
                            "name": "bucketName",
                            "type": "string",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Amazon-aws-s3",
                "version": "1.4.0"
            },
            "uuid": "1b63b19f-6af0-4acb-8481-c95a1f3b0268",
            "coordination": "each",
            "numProcessParallel": "",
            "name": "Backup Bucket Policy via Object",
            "description": "S3 buckets to remediate\n",
            "condition": "checkdeleteremediationviaobject()",
            "filterAgents": null,
            "postRun": "indexRemediate++;",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "name": "getbucketpolicy",
                    "timeout": null,
                    "retries": 0,
                    "method": "getBucketPolicy",
                    "mandatory": null,
                    "params": [
                        {
                            "code": null,
                            "value": "AWS Access Key",
                            "param": null,
                            "viewName": "Access key",
                            "name": "AWS_ACCESS_KEY_ID",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": null,
                            "value": "AWS Secret Key",
                            "param": null,
                            "viewName": "Secret key",
                            "name": "AWS_SECRET_ACCESS_KEY",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getbucketname()",
                            "param": null,
                            "viewName": "Bucket name",
                            "name": "bucketName",
                            "type": "string",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Amazon-aws-s3",
                "version": "1.4.0"
            },
            "uuid": "032cc566-f6ab-41da-a732-ace4300dd5bf",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Backup Bucket Policy via Object",
            "description": "S3 buckets to remediate\n",
            "condition": "checkreplaceremediationviaobject()",
            "filterAgents": null,
            "postRun": "indexRemediate++;",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "6050b655887b20003494e40a",
                            "code": null,
                            "value": "Slack Webhook",
                            "param": null,
                            "name": "webhookUrl"
                        },
                        {
                            "_id": "6050b655887b20003494e40b",
                            "code": true,
                            "value": "sendslackmessageforignored()",
                            "param": null,
                            "name": "message"
                        }
                    ],
                    "name": "sendslackmessageforignored",
                    "timeout": null,
                    "method": "sendIncomingWebhook",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Slack",
                "version": "1.1.0"
            },
            "uuid": "b4b3482a-341b-4b91-add4-81b2ce0587d5",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Ignored",
            "description": null,
            "condition": "checkforignoredslack()",
            "filterAgents": null,
            "postRun": "indexIgnored++;",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "605330d4887b2000349afeb5",
                            "code": true,
                            "value": "getfilepath()",
                            "param": null,
                            "name": "PATH"
                        },
                        {
                            "_id": "605330d4887b2000349afeb6",
                            "code": true,
                            "value": "getfilecontent()",
                            "param": null,
                            "name": "CONTENT"
                        }
                    ],
                    "name": "createfile",
                    "timeout": null,
                    "method": "createFile",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "TextEditor",
                "version": "1.0.0"
            },
            "uuid": "906684b5-8983-4330-9d35-adb8fa078f25",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Create the new JSON file",
            "description": null,
            "condition": "checkconditionfilecreation()",
            "filterAgents": null,
            "postRun": "indexFileCreation++;",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "605330d4887b2000349afeb9",
                            "code": true,
                            "value": "replacebucketpolicyviacli()",
                            "param": null,
                            "name": "COMMANDS"
                        }
                    ],
                    "name": "remediateviacli",
                    "timeout": null,
                    "method": "execute",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "CommandLine",
                "version": "1.2.0"
            },
            "uuid": "3ec01d83-6037-4e13-96f7-fb7372017f59",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Replace Bucket Policy via CLI",
            "description": null,
            "condition": "checkconditionforreplace()",
            "filterAgents": null,
            "postRun": "indexRemediate2++;",
            "preRun": null
        },
        {
            "used_plugin": {
                "name": "Amazon-aws-s3",
                "version": "1.5.4"
            },
            "uuid": "19e20f99-109c-417f-896d-788b0241672b",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Delete Bucket Policy via Object",
            "description": null,
            "mandatory": null,
            "condition": "checkconditionfordeletionviaobject()",
            "actions": [
                {
                    "name": "deletebucketpolicy",
                    "timeout": null,
                    "retries": 0,
                    "method": "deleteBucketPolicy",
                    "mandatory": null,
                    "params": [
                        {
                            "code": null,
                            "value": "AWS Access Key",
                            "param": null,
                            "viewName": "Access key",
                            "name": "AWS_ACCESS_KEY_ID",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": null,
                            "value": "AWS Secret Key",
                            "param": null,
                            "viewName": "Secret key",
                            "name": "AWS_SECRET_ACCESS_KEY",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getbucketnameforremediation()",
                            "param": null,
                            "viewName": "Bucket name",
                            "name": "bucketName",
                            "type": "string",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "correlateAgents": null,
            "filterAgents": null,
            "postRun": "indexRemediate2++;",
            "preRun": null,
            "actionsExecution": "series"
        },
        {
            "used_plugin": {
                "name": "Amazon-aws-s3",
                "version": "1.5.4"
            },
            "uuid": "b177b2f9-9b0b-4803-b7c7-490a9ee2434f",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Replace Bucket Policy via Object",
            "description": null,
            "mandatory": null,
            "condition": "checkconditionforreplace()",
            "actions": [
                {
                    "name": null,
                    "timeout": null,
                    "retries": 0,
                    "method": "putBucketPolicy",
                    "mandatory": null,
                    "params": [
                        {
                            "code": null,
                            "value": "AWS Access Key",
                            "param": null,
                            "viewName": "Access key",
                            "name": "AWS_ACCESS_KEY_ID",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": null,
                            "value": "AWS Secret Key",
                            "param": null,
                            "viewName": "Secret key",
                            "name": "AWS_SECRET_ACCESS_KEY",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getbucketnameforremediation()",
                            "param": null,
                            "viewName": "Bucket name",
                            "name": "bucketName",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "createnewpolicyjson()",
                            "param": null,
                            "viewName": "Policy JSON String",
                            "name": "policy",
                            "type": "string",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "correlateAgents": null,
            "filterAgents": null,
            "postRun": "indexRemediate2++;",
            "preRun": null,
            "actionsExecution": "series"
        },
        {
            "used_plugin": {
                "name": "TextEditor",
                "version": "1.0.0"
            },
            "uuid": "1faf714a-db49-460f-b194-5254b8fd3092",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Create the new JSON file",
            "description": null,
            "mandatory": null,
            "condition": "checkconditionfilecreation()",
            "actions": [
                {
                    "name": "createfile",
                    "timeout": null,
                    "retries": 0,
                    "method": "createFile",
                    "mandatory": null,
                    "params": [
                        {
                            "code": true,
                            "value": "getfilepath()",
                            "param": null,
                            "viewName": "File path",
                            "name": "PATH",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getfilecontent()",
                            "param": null,
                            "viewName": "File Content",
                            "name": "CONTENT",
                            "type": "text",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "correlateAgents": null,
            "filterAgents": null,
            "postRun": "indexFileCreation++;",
            "preRun": null,
            "actionsExecution": "series"
        }
    ],
    "links": [
        {
            "uuid": "1affa0d4-57e5-4932-b053-b835b58296ee",
            "sourceId": "82fbb40a-050c-4f38-b296-761b0ac7ab91",
            "targetId": "2d8ddf58-df9b-4ea7-ad64-356e6176c6bd"
        },
        {
            "uuid": "92180a53-212f-43a5-b78b-534c6bee20de",
            "sourceId": "2d8ddf58-df9b-4ea7-ad64-356e6176c6bd",
            "targetId": "31d9c5ff-ee5b-4a49-b810-ac7dea2377e5"
        },
        {
            "uuid": "cd327359-dc5b-4e46-861e-31e5948d077d",
            "sourceId": "31d9c5ff-ee5b-4a49-b810-ac7dea2377e5",
            "targetId": "31d9c5ff-ee5b-4a49-b810-ac7dea2377e5"
        },
        {
            "uuid": "d9554f91-5fbb-43d9-a814-03bd2130688e",
            "sourceId": "2d8ddf58-df9b-4ea7-ad64-356e6176c6bd",
            "targetId": "335c4aa0-b21b-419c-8235-79cfd5bc57dd"
        },
        {
            "uuid": "eabe74e7-0949-48b8-8b25-25be5cd6b4e8",
            "sourceId": "335c4aa0-b21b-419c-8235-79cfd5bc57dd",
            "targetId": "335c4aa0-b21b-419c-8235-79cfd5bc57dd"
        },
        {
            "uuid": "d06c3f0e-5367-4ced-944d-1ad19c7ac9ad",
            "sourceId": "d6566c62-481d-40e2-b823-ba8c9fa9f31c",
            "targetId": "d6566c62-481d-40e2-b823-ba8c9fa9f31c"
        },
        {
            "uuid": "558e3cd7-c2f6-466c-a247-95c4a723ecbb",
            "sourceId": "2d8ddf58-df9b-4ea7-ad64-356e6176c6bd",
            "targetId": "d6566c62-481d-40e2-b823-ba8c9fa9f31c"
        },
        {
            "uuid": "385b3904-485b-4ec6-a4be-438a7bc38955",
            "sourceId": "1b63b19f-6af0-4acb-8481-c95a1f3b0268",
            "targetId": "1b63b19f-6af0-4acb-8481-c95a1f3b0268"
        },
        {
            "uuid": "5d798356-2378-43c1-ba4a-21aa1bceabb6",
            "sourceId": "032cc566-f6ab-41da-a732-ace4300dd5bf",
            "targetId": "032cc566-f6ab-41da-a732-ace4300dd5bf"
        },
        {
            "uuid": "8a3447f8-cdfb-41e1-90a4-e97ada1cbde3",
            "sourceId": "b4b3482a-341b-4b91-add4-81b2ce0587d5",
            "targetId": "b4b3482a-341b-4b91-add4-81b2ce0587d5"
        },
        {
            "uuid": "ad4a2f10-a641-475a-92f8-5a6b9c49fc45",
            "sourceId": "335c4aa0-b21b-419c-8235-79cfd5bc57dd",
            "targetId": "b4b3482a-341b-4b91-add4-81b2ce0587d5"
        },
        {
            "uuid": "2d2ffdc7-5d8f-4f37-98a2-f6a0eee2bdcc",
            "sourceId": "2d8ddf58-df9b-4ea7-ad64-356e6176c6bd",
            "targetId": "1b63b19f-6af0-4acb-8481-c95a1f3b0268"
        },
        {
            "uuid": "cd2ffa22-5be9-4625-af6b-ce6a1c6448e0",
            "sourceId": "2d8ddf58-df9b-4ea7-ad64-356e6176c6bd",
            "targetId": "032cc566-f6ab-41da-a732-ace4300dd5bf"
        },
        {
            "uuid": "12853e1c-43ac-490a-9412-f286991ecf85",
            "sourceId": "d6566c62-481d-40e2-b823-ba8c9fa9f31c",
            "targetId": "906684b5-8983-4330-9d35-adb8fa078f25"
        },
        {
            "uuid": "9ee2f71a-ae8a-477c-9924-58546ca37c62",
            "sourceId": "906684b5-8983-4330-9d35-adb8fa078f25",
            "targetId": "906684b5-8983-4330-9d35-adb8fa078f25"
        },
        {
            "uuid": "e1b5f466-7efd-4e97-9eb7-b04cedc9b32c",
            "sourceId": "3ec01d83-6037-4e13-96f7-fb7372017f59",
            "targetId": "3ec01d83-6037-4e13-96f7-fb7372017f59"
        },
        {
            "uuid": "e1230f8c-d233-4be3-9746-4dd36e85c6d6",
            "sourceId": "906684b5-8983-4330-9d35-adb8fa078f25",
            "targetId": "3ec01d83-6037-4e13-96f7-fb7372017f59"
        },
        {
            "uuid": "288aeb20-a202-41b3-9a98-926c6b90fba9",
            "sourceId": "1faf714a-db49-460f-b194-5254b8fd3092",
            "targetId": "1faf714a-db49-460f-b194-5254b8fd3092"
        },
        {
            "uuid": "10e26180-7c52-4ebd-9d60-c59a12149285",
            "sourceId": "19e20f99-109c-417f-896d-788b0241672b",
            "targetId": "19e20f99-109c-417f-896d-788b0241672b"
        },
        {
            "uuid": "dacc0bb4-8db7-499c-a82a-4ef907c4c323",
            "sourceId": "b177b2f9-9b0b-4803-b7c7-490a9ee2434f",
            "targetId": "b177b2f9-9b0b-4803-b7c7-490a9ee2434f"
        },
        {
            "uuid": "090482e6-9623-4848-ab30-2e0dfa878506",
            "sourceId": "032cc566-f6ab-41da-a732-ace4300dd5bf",
            "targetId": "1faf714a-db49-460f-b194-5254b8fd3092"
        },
        {
            "uuid": "4153f5cf-4c2c-4599-b1c2-6b116c3709d3",
            "sourceId": "1faf714a-db49-460f-b194-5254b8fd3092",
            "targetId": "b177b2f9-9b0b-4803-b7c7-490a9ee2434f"
        },
        {
            "uuid": "ab6b1e14-11ba-40ff-b694-0551e114fdbd",
            "sourceId": "1b63b19f-6af0-4acb-8481-c95a1f3b0268",
            "targetId": "19e20f99-109c-417f-896d-788b0241672b"
        }
    ],
    "content": "{\"cells\":[{\"type\":\"devs.PMStartPoint\",\"size\":{\"width\":40,\"height\":39},\"outPorts\":[\" \"],\"inPorts\":[],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\" \"}}}]},\"position\":{\"x\":50,\"y\":20},\"angle\":0,\"id\":\"82fbb40a-050c-4f38-b296-761b0ac7ab91\",\"z\":1,\"attrs\":{\"rect\":{\"fill\":\"#2d3236\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":219,\"y\":6},\"angle\":0,\"id\":\"2d8ddf58-df9b-4ea7-ad64-356e6176c6bd\",\"z\":2,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Get event details\"},\".p_id\":{\"text\":\"6023b2e264b1160034fd9b9f\"},\"image\":{\"xlink:href\":\"/plugins/lacework/lacework.png\",\"ref-y\":50},\"text\":{\"text\":\"Get event details\"}}},{\"type\":\"link\",\"source\":{\"id\":\"82fbb40a-050c-4f38-b296-761b0ac7ab91\",\"port\":\" \"},\"target\":{\"id\":\"2d8ddf58-df9b-4ea7-ad64-356e6176c6bd\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"1affa0d4-57e5-4932-b053-b835b58296ee\",\"z\":3,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":446,\"y\":-311},\"angle\":0,\"id\":\"31d9c5ff-ee5b-4a49-b810-ac7dea2377e5\",\"z\":4,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Delete Bucket Policy via CLI\"},\".p_id\":{\"text\":\"5f92a2f3da3961001ab1a0c4\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Delete Bucket Policy via CLI\"}}},{\"type\":\"link\",\"source\":{\"id\":\"2d8ddf58-df9b-4ea7-ad64-356e6176c6bd\",\"port\":\"  \"},\"target\":{\"id\":\"31d9c5ff-ee5b-4a49-b810-ac7dea2377e5\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"92180a53-212f-43a5-b78b-534c6bee20de\",\"z\":5,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"31d9c5ff-ee5b-4a49-b810-ac7dea2377e5\",\"port\":\"  \"},\"target\":{\"id\":\"31d9c5ff-ee5b-4a49-b810-ac7dea2377e5\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"cd327359-dc5b-4e46-861e-31e5948d077d\",\"z\":6,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":443,\"y\":302},\"angle\":0,\"id\":\"335c4aa0-b21b-419c-8235-79cfd5bc57dd\",\"z\":7,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Remediated\"},\".p_id\":{\"text\":\"5f92a31fda3961001ab1a1a6\"},\"image\":{\"xlink:href\":\"/plugins/Slack/Slack_Icon.png\",\"ref-y\":50},\"text\":{\"text\":\"Remediated\"}}},{\"type\":\"link\",\"source\":{\"id\":\"2d8ddf58-df9b-4ea7-ad64-356e6176c6bd\",\"port\":\"  \"},\"target\":{\"id\":\"335c4aa0-b21b-419c-8235-79cfd5bc57dd\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"d9554f91-5fbb-43d9-a814-03bd2130688e\",\"z\":8,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"335c4aa0-b21b-419c-8235-79cfd5bc57dd\",\"port\":\"  \"},\"target\":{\"id\":\"335c4aa0-b21b-419c-8235-79cfd5bc57dd\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"eabe74e7-0949-48b8-8b25-25be5cd6b4e8\",\"z\":9,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":485,\"y\":-148},\"angle\":0,\"id\":\"d6566c62-481d-40e2-b823-ba8c9fa9f31c\",\"z\":10,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Create Backup via CLI\"},\".p_id\":{\"text\":\"5f92a2f3da3961001ab1a0c4\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Create Backup via CLI\"}}},{\"type\":\"link\",\"source\":{\"id\":\"d6566c62-481d-40e2-b823-ba8c9fa9f31c\",\"port\":\"  \"},\"target\":{\"id\":\"d6566c62-481d-40e2-b823-ba8c9fa9f31c\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"d06c3f0e-5367-4ced-944d-1ad19c7ac9ad\",\"z\":11,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"2d8ddf58-df9b-4ea7-ad64-356e6176c6bd\",\"port\":\"  \"},\"target\":{\"id\":\"d6566c62-481d-40e2-b823-ba8c9fa9f31c\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"558e3cd7-c2f6-466c-a247-95c4a723ecbb\",\"z\":12,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":548,\"y\":-1},\"angle\":0,\"id\":\"1b63b19f-6af0-4acb-8481-c95a1f3b0268\",\"z\":13,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Backup Bucket Policy via Object\"},\".p_id\":{\"text\":\"6047970a887b2000347ea8bd\"},\"image\":{\"xlink:href\":\"/plugins/Amazon-aws-s3/logo.png\",\"ref-y\":50},\"text\":{\"text\":\"Backup Bucket Policy via Object\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":495,\"y\":160},\"angle\":0,\"id\":\"032cc566-f6ab-41da-a732-ace4300dd5bf\",\"z\":14,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Backup Bucket Policy via Object\"},\".p_id\":{\"text\":\"6047970a887b2000347ea8bd\"},\"image\":{\"xlink:href\":\"/plugins/Amazon-aws-s3/logo.png\",\"ref-y\":50},\"text\":{\"text\":\"Backup Bucket Policy via Object\"}}},{\"type\":\"link\",\"source\":{\"id\":\"1b63b19f-6af0-4acb-8481-c95a1f3b0268\",\"port\":\"  \"},\"target\":{\"id\":\"1b63b19f-6af0-4acb-8481-c95a1f3b0268\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"385b3904-485b-4ec6-a4be-438a7bc38955\",\"z\":15,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"032cc566-f6ab-41da-a732-ace4300dd5bf\",\"port\":\"  \"},\"target\":{\"id\":\"032cc566-f6ab-41da-a732-ace4300dd5bf\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"5d798356-2378-43c1-ba4a-21aa1bceabb6\",\"z\":16,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":720,\"y\":303},\"angle\":0,\"id\":\"b4b3482a-341b-4b91-add4-81b2ce0587d5\",\"z\":17,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Ignored\"},\".p_id\":{\"text\":\"5f92a31fda3961001ab1a1a6\"},\"image\":{\"xlink:href\":\"/plugins/Slack/Slack_Icon.png\",\"ref-y\":50},\"text\":{\"text\":\"Ignored\"}}},{\"type\":\"link\",\"source\":{\"id\":\"b4b3482a-341b-4b91-add4-81b2ce0587d5\",\"port\":\"  \"},\"target\":{\"id\":\"b4b3482a-341b-4b91-add4-81b2ce0587d5\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"8a3447f8-cdfb-41e1-90a4-e97ada1cbde3\",\"z\":18,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"335c4aa0-b21b-419c-8235-79cfd5bc57dd\",\"port\":\"  \"},\"target\":{\"id\":\"b4b3482a-341b-4b91-add4-81b2ce0587d5\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"ad4a2f10-a641-475a-92f8-5a6b9c49fc45\",\"z\":19,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"2d8ddf58-df9b-4ea7-ad64-356e6176c6bd\",\"port\":\"  \"},\"target\":{\"id\":\"1b63b19f-6af0-4acb-8481-c95a1f3b0268\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"2d2ffdc7-5d8f-4f37-98a2-f6a0eee2bdcc\",\"z\":20,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"2d8ddf58-df9b-4ea7-ad64-356e6176c6bd\",\"port\":\"  \"},\"target\":{\"id\":\"032cc566-f6ab-41da-a732-ace4300dd5bf\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"cd2ffa22-5be9-4625-af6b-ce6a1c6448e0\",\"z\":21,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":743,\"y\":-149},\"angle\":0,\"id\":\"906684b5-8983-4330-9d35-adb8fa078f25\",\"z\":22,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Create the new JSON file\"},\".p_id\":{\"text\":\"5f92a324da3961001ab1a1bf\"},\"image\":{\"xlink:href\":\"/plugins/TextEditor/TextEditor.png\",\"ref-y\":50},\"text\":{\"text\":\"Create the new JSON file\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":996,\"y\":-148},\"angle\":0,\"id\":\"3ec01d83-6037-4e13-96f7-fb7372017f59\",\"z\":23,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Replace Bucket Policy via CLI\"},\".p_id\":{\"text\":\"5f92a2f3da3961001ab1a0c4\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Replace Bucket Policy via CLI\"}}},{\"type\":\"link\",\"source\":{\"id\":\"d6566c62-481d-40e2-b823-ba8c9fa9f31c\",\"port\":\"  \"},\"target\":{\"id\":\"906684b5-8983-4330-9d35-adb8fa078f25\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"12853e1c-43ac-490a-9412-f286991ecf85\",\"z\":24,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"906684b5-8983-4330-9d35-adb8fa078f25\",\"port\":\"  \"},\"target\":{\"id\":\"906684b5-8983-4330-9d35-adb8fa078f25\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"9ee2f71a-ae8a-477c-9924-58546ca37c62\",\"z\":25,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"3ec01d83-6037-4e13-96f7-fb7372017f59\",\"port\":\"  \"},\"target\":{\"id\":\"3ec01d83-6037-4e13-96f7-fb7372017f59\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"e1b5f466-7efd-4e97-9eb7-b04cedc9b32c\",\"z\":26,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"906684b5-8983-4330-9d35-adb8fa078f25\",\"port\":\"  \"},\"target\":{\"id\":\"3ec01d83-6037-4e13-96f7-fb7372017f59\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"e1230f8c-d233-4be3-9746-4dd36e85c6d6\",\"z\":27,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":782,\"y\":-1},\"angle\":0,\"id\":\"19e20f99-109c-417f-896d-788b0241672b\",\"z\":28,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Delete Bucket Policy via Object\"},\".p_id\":{\"text\":\"6047970a887b2000347ea8bd\"},\"image\":{\"xlink:href\":\"/plugins/Amazon-aws-s3/logo.png\",\"ref-y\":50},\".inPorts circle\":{\"fill\":\"#c8c8c8\"},\".outPorts circle\":{\"fill\":\"#262626\"},\"text\":{\"text\":\"Delete Bucket Policy via Object\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":1004,\"y\":159},\"angle\":0,\"id\":\"b177b2f9-9b0b-4803-b7c7-490a9ee2434f\",\"z\":29,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Replace Bucket Policy via Object\"},\".p_id\":{\"text\":\"6047970a887b2000347ea8bd\"},\"image\":{\"xlink:href\":\"/plugins/Amazon-aws-s3/logo.png\",\"ref-y\":50},\".inPorts circle\":{\"fill\":\"#c8c8c8\"},\".outPorts circle\":{\"fill\":\"#262626\"},\"text\":{\"text\":\"Replace Bucket Policy via Object\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":747,\"y\":160},\"angle\":0,\"id\":\"1faf714a-db49-460f-b194-5254b8fd3092\",\"z\":30,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Create the new JSON file\"},\".p_id\":{\"text\":\"5f92a324da3961001ab1a1bf\"},\"image\":{\"xlink:href\":\"/plugins/TextEditor/TextEditor.png\",\"ref-y\":50},\".inPorts circle\":{\"fill\":\"#c8c8c8\"},\".outPorts circle\":{\"fill\":\"#262626\"},\"text\":{\"text\":\"Create the new JSON file\"}}},{\"type\":\"link\",\"source\":{\"id\":\"1faf714a-db49-460f-b194-5254b8fd3092\",\"port\":\"  \"},\"target\":{\"id\":\"1faf714a-db49-460f-b194-5254b8fd3092\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"288aeb20-a202-41b3-9a98-926c6b90fba9\",\"z\":31,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"19e20f99-109c-417f-896d-788b0241672b\",\"port\":\"  \"},\"target\":{\"id\":\"19e20f99-109c-417f-896d-788b0241672b\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"10e26180-7c52-4ebd-9d60-c59a12149285\",\"z\":32,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"b177b2f9-9b0b-4803-b7c7-490a9ee2434f\",\"port\":\"  \"},\"target\":{\"id\":\"b177b2f9-9b0b-4803-b7c7-490a9ee2434f\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"dacc0bb4-8db7-499c-a82a-4ef907c4c323\",\"z\":33,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"032cc566-f6ab-41da-a732-ace4300dd5bf\",\"port\":\"  \"},\"target\":{\"id\":\"1faf714a-db49-460f-b194-5254b8fd3092\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"090482e6-9623-4848-ab30-2e0dfa878506\",\"z\":34,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"1faf714a-db49-460f-b194-5254b8fd3092\",\"port\":\"  \"},\"target\":{\"id\":\"b177b2f9-9b0b-4803-b7c7-490a9ee2434f\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"4153f5cf-4c2c-4599-b1c2-6b116c3709d3\",\"z\":35,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"1b63b19f-6af0-4acb-8481-c95a1f3b0268\",\"port\":\"  \"},\"target\":{\"id\":\"19e20f99-109c-417f-896d-788b0241672b\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"ab6b1e14-11ba-40ff-b694-0551e114fdbd\",\"z\":36,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}}]}",
    "used_plugins": [
        {
            "name": "lacework",
            "version": "1.0.0"
        },
        {
            "name": "CommandLine",
            "version": "1.2.0"
        },
        {
            "name": "Slack",
            "version": "1.1.0"
        },
        {
            "name": "CommandLine",
            "version": "1.2.0"
        },
        {
            "name": "Amazon-aws-s3",
            "version": "1.4.0"
        },
        {
            "name": "Amazon-aws-s3",
            "version": "1.4.0"
        },
        {
            "name": "Slack",
            "version": "1.1.0"
        },
        {
            "name": "TextEditor",
            "version": "1.0.0"
        },
        {
            "name": "CommandLine",
            "version": "1.2.0"
        }
    ],
    "__v": 0,
    "code": "var bucketArr = []; // Array of S3 Buckets that will be filled with the resource information from the event.\nvar indexRemediate = 0; // Index for the S3 Bucket Remediate of the Map\nvar indexSlack = 0; // Index of the Slack Loop to send out information about the S3 Bucket remediation.\nvar bucketIgnoredArr = []; // Array of S3 Buckets that are violating but will be ignored.\nvar indexIgnored = 0; //Index of the S3 Buckets that are violating but will be ignored.\nvar indexFileCreation = 0; //Index for creation of the JSON files.\nvar indexRemediate2 = 0; //Index for a second CLI command used to replace the policy\n\nlet payload = trigger.payload; // The Payload that was send by the Webhook Trigger. Information about the Payload is available at https://support.lacework.com/hc/en-us/articles/360034367393-Webhook\n\nfunction checkconfiguration()  { // Function to check if two out of four Auto Remediation steps are enabled.\n    if (configuration.dothedeletebucketpolicyremediationviacli == \"true\" && configuration.dothereplacebucketpolicyremediationviacli == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothedeletebucketpolicyremediationviacli == \"true\" && configuration.dothedeletebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothedeletebucketpolicyremediationviacli == \"true\" && configuration.dothereplacebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothereplacebucketpolicyremediationviacli == \"true\" && configuration.dothedeletebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothereplacebucketpolicyremediationviacli == \"true\" && configuration.dothereplacebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothereplacebucketpolicyremediationviaobject == \"true\" && configuration.dothedeletebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else {\n        return 1;\n    }\n}\n\nfunction geteventid() { // Function to get the Event ID from the Webhook Payload.\n    return `${payload.event_id}`;\n}\n\nfunction createBucketList() { // Function to build the S3 Bucket List that will be used to Remediate.\n    let p = configuration.eventuuid;\n    let laceworkAPIResult = getAction(p);\n    let resourcesArr = laceworkAPIResult.result.result.data[0].ENTITY_MAP.Resource;\n    for (let i = 0; i < resourcesArr.length; i++) {\n        if (!configuration.bucketIgnoreList.includes(resourcesArr[i].VALUE)) { // The S3 Bucket of the Event will be checked against the configuration list of to ignore S3 buckets.\n            bucketArr.push (resourcesArr[i].VALUE); // If the bucket is not on the list it will be pushed into the array.\n        }\n        else {\n            bucketIgnoredArr.push (resourcesArr[i].VALUE); // If the bucket is on the list and violating the policy it will be pushed into the second bucket list.\n        }\n    }\n}\n\nfunction printBucketName() { // Function to print the S3 buckets that will be remediated.\n    let bucket = bucketArr[indexRemediate]\n    let arr = bucket.split(\":::\")\n    return `echo Compliance Violation ${configuration.policyID} for the S3 bucket ${arr[arr.length-1]}`;\n}\n\nfunction createbackup() { // Function to backup the S3 bucket policy before it is replaced.\n    if (configuration.createbackup == \"true\") {\n        let bucket = bucketArr[indexRemediate]\n        let arr = bucket.split(\":::\")\n        let currentdate = Date.now();\n        return `aws s3api get-bucket-policy --bucket ${arr[arr.length-1]} > ${configuration.backupfolder}${arr[arr.length-1]}-${currentdate}-${configuration.policyID}.json`; \n    }\n    else {\n        return `Creating backup inside the configuration is disabled. Skipping.`\n    }\n}\n\nfunction deleteviaawscli() { // Delete the Bucket Policy via CLI\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    return `aws s3api delete-bucket-policy --bucket ${arr[arr.length-1]}`; // Using the delete-bucket-policy method. Feel free to replace it with whatever you think is the right aws cli command to trigger.\n}\n\nfunction createnewpolicyfile() { // Optional (Not in use): A way how you can create the JSON file on the command line.\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    configuration.bucketpolicy.Statement[0].Resource = bucket;\n    const myjson = JSON.stringify(configuration.bucketpolicy)\n    let myoutput = myjson.replace(/\"/g, '\\\"');\n    return `echo \"${myoutput}\" > ${configuration.inputfolder}${arr[arr.length-1]}-${configuration.policyID}.json`;\n}\n\nfunction checkconditionfilecreation() { //Check condition of the file creation texteditor object if it can execute.\n    if (indexRemediate == bucketArr.length && indexFileCreation < bucketArr.length) return true\n    return false\n}\n\nfunction getfilepath() { //Getting the filepath and name for the file that will be created.\n    let bucket = bucketArr[indexFileCreation];\n    let arr = bucket.split(\":::\");\n    return `${configuration.inputfolder}${arr[arr.length-1]}-${configuration.policyID}.json`;\n}\n\nfunction getfilecontent() { //Getting the file content of what will be written into the file itself.\n    let bucket = bucketArr[indexFileCreation];\n    let arr = bucket.split(\":::\");\n    configuration.bucketpolicy.Statement[0].Resource = bucket;\n    const myjson = JSON.stringify(configuration.bucketpolicy);\n    return `${myjson}`;\n}\n\nfunction checkconditionforreplace() { //Check the condition for replace the current bucket policy via the CLI.\n    if (indexRemediate == bucketArr.length && indexFileCreation == bucketArr.length && indexRemediate2 < bucketArr.length) return true\n    return false\n}\n\nfunction replacebucketpolicyviacli() { // Replace the Bucket Policy via CLI\n    let bucket = bucketArr[indexRemediate2];\n    let arr = bucket.split(\":::\");\n    configuration.bucketpolicy.Statement[0].Resource = bucket;\n    let myoutput = JSON.stringify(configuration.bucketpolicy);\n    return `aws s3api put-bucket-policy --bucket ${arr[arr.length-1]} --policy file://${configuration.inputfolder}${arr[arr.length-1]}-${configuration.policyID}.json`; //Using the setting --acl private. Feel free to replace it with whatever you think is the right aws cli command to trigger.\n}\n\nfunction getbucketname() { // Function to print the S3 buckets that will be remediated.\n    let bucket = bucketArr[indexRemediate]\n    let arr = bucket.split(\":::\")\n    return `${arr[arr.length-1]}`;\n}\n\nfunction checkconditionfordeletionviaobject() {\n    if (indexRemediate == bucketArr.length && indexRemediate2 < bucketArr.length) return true\n    return false\n}\n\nfunction getbucketnameforremediation() {\n    let bucket = bucketArr[indexRemediate2]\n    let arr = bucket.split(\":::\")\n    return `${arr[arr.length-1]}`;\n}\n\nfunction createnewpolicyjson() { // Optional (Not in use): A way how you can create the JSON file on the command line.\n    let bucket = bucketArr[indexRemediate2];\n    let arr = bucket.split(\":::\");\n    configuration.bucketpolicy.Statement[0].Resource = bucket;\n    const myjson = JSON.stringify(configuration.bucketpolicy)\n    //let myoutput = myjson.replace(/\"/g, '\\\"');\n    return `${myjson}`;\n}\n\nfunction testprint () { // Test Print, not in use so far.\n   configuration.bucketpolicy.Statement[0].Resource = \"adflkasdflkjasdf\"\n   let myoutput = JSON.stringify(configuration.bucketpolicy);\n   return `echo ${myoutput}`;\n}\n\nfunction remediateviaobject() { // Remediate the S3 buckets back to private acl.\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    return `${arr[arr.length-1]}`; //Using the canned acl private.\n}\n\nfunction sendslackmessage() { // Function to send out a slack message for every S3 bucket that will be remediated.\n    let bucket = bucketArr[indexSlack];\n    let arr = bucket.split(\":::\");\n    let event_link = payload.event_link;\n    if (configuration.dothedeletebucketpolicyremediationviacli == \"true\") {\n        return `Compliance Violation ${configuration.policyID} The following S3 bucket is auto remediated back to ${configuration.violationdescription}: ${arr[arr.length-1]}. Executing CLI command aws s3api delete-bucket-policy --bucket ${arr[arr.length-1]}. More information about the event is available at ${event_link}`;\n    }\n    else if (configuration.dothereplacebucketpolicyremediationviacli == \"true\") {\n        return `Compliance Violation ${configuration.policyID} The following S3 bucket is auto remediated back to ${configuration.violationdescription}: ${arr[arr.length-1]}. Executing CLI command aws s3api put-bucket-policy --bucket ${arr[arr.length-1]} --policy file://${configuration.inputfolder}${arr[arr.length-1]}.json. More information about the event is available at ${event_link}`;\n    }\n    else if (configuration.dothedeletebucketpolicyremediationviaobject == \"true\") {\n        return `Compliance Violation ${configuration.policyID} The following S3 bucket is auto remediated back to ${configuration.violationdescription}: ${arr[arr.length-1]}. Using the Kaholo S3 object to do the delete of the bucket policy remediation. More information about the event is available at ${event_link}`;\n    }\n    else if (configuration.dothereplacebucketpolicyremediationviaobject == \"true\") {\n        return `Compliance Violation ${configuration.policyID} The following S3 bucket is auto remediated back to ${configuration.violationdescription}: ${arr[arr.length-1]}. Using the Kaholo S3 object to do the replace of the bucket policy remediation. More information about the event is available at ${event_link}`;\n    }\n    else {\n        return `Compliance Violation ${configuration.policyID}. Auto Remediation is diabled! The following S3 bucket would be auto remediated ${configuration.violationdescription}: ${arr[arr.length-1]}. More information about the event is available at ${event_link}`;   \n    }\n}\n\nfunction sendslackmessageforignored() { // Function to send out a slack message for every S3 bucket that will be ignored but is violating the policy.\n    let bucket = bucketIgnoredArr[indexIgnored];\n    let arr = bucket.split(\":::\");\n    let event_link = payload.event_link;\n    return `Compliance Violation ${configuration.policyID} The following S3 bucket is NOT remediated back to ${configuration.violationdescription}: ${arr[arr.length-1]}. It is ignored by the configuration of the Map. We recommend using tags in AWS to suppress this S3 bucket from triggering alerts in Lacework. More information about the event is available at ${event_link}`;    \n}\n\nfunction checkdeleteremediationviacli() //Check if the Delete Remedation should be done via the CLI?\n{\n    if (configuration.dothedeletebucketpolicyremediationviacli == \"true\") {\n        if (indexRemediate < bucketArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction checkreplaceremediationviacli() //Check if the Replace Remedation should be done via the CLI?\n{\n    if (configuration.dothereplacebucketpolicyremediationviacli == \"true\") {\n        if (indexRemediate < bucketArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\n\n\nfunction checkdeleteremediationviaobject() //Check if the Delete Remedation should be done via the Object?\n{\n    if (configuration.dothedeletebucketpolicyremediationviaobject == \"true\") {\n        if (indexRemediate < bucketArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\nfunction checkreplaceremediationviaobject() //Check if the Replace Remedation should be done via the Object?\n{\n    if (configuration.dothereplacebucketpolicyremediationviaobject == \"true\") {\n        if (indexRemediate < bucketArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction checkforignoredslack() { //Check if you want to also see the ignored buckets via the slack messages.\n    if (indexSlack == bucketArr.length && indexIgnored < bucketIgnoredArr.length && configuration.sendslackmessagesforignored == \"true\") {\n        return 1;\n    }\n    else {\n         return 0;\n    }\n}\n\nfunction getAction(pId) {  // Help function to get the return value of the event.\n   let p = getProcessById(pId)//Get the process. \n   if(!p ||!p.length)return; \n   p = p[p.length-1].actions; //Get all actions \n   let action = p[Object.keys(p)[0]];//get the needed action \n   return action \n}"
}