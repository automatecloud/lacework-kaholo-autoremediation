{
    "configurations": [
        {
            "_id": "615f0bb2f0c3640039eee2a3",
            "name": "LaceworkConfig",
            "value": "{\n    \"name\": \"LaceworkConfiguration\",\n    \"rec_id\": \"LW_S3_13\",\n    \"violationdescription\": \"Ensure the S3 bucket has access logging enabled\",\n    \"eventuuid\": \"42bb48ed-ae0a-4093-854d-2dc6777f618d\",\n    \"reportuuid\": \"a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a\",\n    \"enablebucketloggingviacli\": \"false\",\n    \"enablebucketloggingviaobject\": \"false\",\n    \"sendslackmessagesforremediation\": \"false\",\n    \"sendslackmessagesforignored\": \"false\",\n    \"sendslackstatistics\": \"false\",\n    \"bucketIgnoreList\": [\n        \"arn:aws:s3:::mybucket01\",\n        \"arn:aws:s3:::mybucket02\",\n        \"arn:aws:s3:::mybucket03\"\n    ],\n    \"awsaccountid\": \"12345678912\",\n    \"reporttype\": \"AWS_CIS_S3\",\n    \"putbuckettaggingviacli\": \"false\",\n    \"putbuckettaggingviaobject\": \"false\",\n    \"tagname\": \"LW_S3_13\",\n    \"tagvalue\": \"suppressed\",\n    \"configuresuppressiononpolicy\": \"false\",\n    \"suppressionpolicycomment\": \"Auto Configured via Kaholo\",\n    \"autoremediationonlyfornewviolations\": \"false\",\n    \"suppressionuuid\": \"5dd89842-a6c2-4615-badd-ae2301c62d9b\",\n    \"inputfolder\": \"/usr/src/app/scripts/input/\",\n    \"loggingconfiguration\": {\n        \"LoggingEnabled\": {\n            \"TargetBucket\": \"mytargetbucketforlogging\",\n            \"TargetPrefix\": \"MyBucketLogs/\",\n            \"TargetGrants\": [\n                {\n                    \"Grantee\": {\n                        \"Type\": \"Group\",\n                        \"URI\": \"http://acs.amazonaws.com/groups/s3/LogDelivery\"\n                    },\n                    \"Permission\": \"WRITE\"\n                },\n                {\n                    \"Grantee\": {\n                        \"Type\": \"Group\",\n                        \"URI\": \"http://acs.amazonaws.com/groups/s3/LogDelivery\"\n                    },\n                    \"Permission\": \"READ_ACP\"\n                }\n            ]\n        }\n    }\n}",
            "mapRevision": "615f0bb2f0c3640039eee230",
            "__v": 0
        }
    ],
    "processes": [
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "60984a26d0f6e00034e4160f",
                            "code": true,
                            "value": "geteventid()",
                            "param": "6059c423257f080034096506",
                            "name": "EVENT_ID"
                        }
                    ],
                    "name": "geteventid",
                    "timeout": null,
                    "method": "GetEventDetails",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "lacework",
                "version": "1.0.0"
            },
            "uuid": "42bb48ed-ae0a-4093-854d-2dc6777f618d",
            "numProcessParallel": null,
            "name": "Get event details",
            "description": null,
            "condition": "checkconfigurationforevent()",
            "coordination": null,
            "filterAgents": null,
            "postRun": "createBucketList() ",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "615f0bb2f0c3640039eee236",
                            "code": null,
                            "value": null,
                            "param": null,
                            "name": "workingDir"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee237",
                            "code": true,
                            "value": "printBucketName()",
                            "param": null,
                            "name": "COMMANDS"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee238",
                            "code": null,
                            "value": null,
                            "param": null,
                            "name": "exitOnClose"
                        }
                    ],
                    "name": "printBucketName",
                    "timeout": null,
                    "method": "execute",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "CommandLine",
                "version": "1.2.0"
            },
            "uuid": "d78986e7-d694-43d3-84de-81cd5b8fa2f6",
            "numProcessParallel": null,
            "name": "Enable Bucket Logging via CLI",
            "description": "S3 buckets to remediate\n",
            "condition": "checkremediationviacli()",
            "filterAgents": null,
            "postRun": "",
            "preRun": null,
            "coordination": "each"
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "615ef98ff0c3640039eeabf0",
                            "code": null,
                            "value": "Slack Webhook",
                            "param": "613888a49cf4100039826c78",
                            "name": "webhookUrl"
                        },
                        {
                            "_id": "615ef98ff0c3640039eeabf1",
                            "code": true,
                            "value": "sendslackmessage()",
                            "param": "613888a49cf4100039826c79",
                            "name": "message"
                        }
                    ],
                    "name": "informsecurity",
                    "timeout": null,
                    "method": "sendIncomingWebhook",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Slack",
                "version": "1.1.0"
            },
            "uuid": "6c03b7c3-3646-42f2-ab0e-96989cd3dfae",
            "numProcessParallel": null,
            "name": "Remediated",
            "description": null,
            "condition": "checkforslack()",
            "filterAgents": null,
            "postRun": "indexSlack++;",
            "preRun": null,
            "coordination": "each"
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "61546d6e9cf4100039c59dda",
                            "code": true,
                            "value": "getawsaccesskeyfromvaultforremediation()",
                            "param": "60984a26d0f6e00034e41619",
                            "name": "AWS_ACCESS_KEY_ID"
                        },
                        {
                            "_id": "61546d6e9cf4100039c59ddb",
                            "code": true,
                            "value": "getawssecretkeyfromvaultforremediation()",
                            "param": "60984a26d0f6e00034e4161a",
                            "name": "AWS_SECRET_ACCESS_KEY"
                        },
                        {
                            "_id": "61546d6e9cf4100039c59ddc",
                            "code": true,
                            "value": "getTargetBucketName()",
                            "param": "60984a26d0f6e00034e4161b",
                            "name": "BUCKET_NAME"
                        },
                        {
                            "_id": "61546d6e9cf4100039c59ddd",
                            "code": null,
                            "value": "GrantWrite",
                            "param": "60984a26d0f6e00034e4161c",
                            "name": "objGrantType"
                        },
                        {
                            "_id": "61546d6e9cf4100039c59dde",
                            "code": null,
                            "value": "GrantReadACP",
                            "param": "60984a26d0f6e00034e4161d",
                            "name": "aclGrantType"
                        },
                        {
                            "_id": "61546d6e9cf4100039c59ddf",
                            "code": null,
                            "value": "http://acs.amazonaws.com/groups/s3/LogDelivery",
                            "param": "60984a26d0f6e00034e4161e",
                            "name": "URI"
                        },
                        {
                            "_id": "61546d6e9cf4100039c59de0",
                            "code": null,
                            "value": null,
                            "param": "60984a26d0f6e00034e4161f",
                            "name": "userID"
                        },
                        {
                            "_id": "61546d6e9cf4100039c59de1",
                            "code": null,
                            "value": null,
                            "param": "60984a26d0f6e00034e41620",
                            "name": "emailAddress"
                        }
                    ],
                    "name": "changeaclfortargetbucket",
                    "timeout": null,
                    "method": "putBucketAcl",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Amazon-aws-s3",
                "version": "1.5.4"
            },
            "uuid": "83725c35-de1b-4c04-81e5-32dd242852b4",
            "numProcessParallel": null,
            "name": "Change Target Bucket ACL via Object",
            "description": "",
            "condition": "checkremediationviaobject()",
            "coordination": "each",
            "filterAgents": null,
            "postRun": "",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "615f0bb2f0c3640039eee249",
                            "code": true,
                            "value": "getfilepath()",
                            "param": "61546d6e9cf4100039c59de4",
                            "name": "PATH"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee24a",
                            "code": true,
                            "value": "getfilecontent()",
                            "param": "61546d6e9cf4100039c59de5",
                            "name": "CONTENT"
                        }
                    ],
                    "name": "createfile",
                    "timeout": null,
                    "method": "createFile",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "TextEditor",
                "version": "1.0.0"
            },
            "uuid": "af4fd499-20e7-40bd-8cb3-97fb9cf86be4",
            "numProcessParallel": null,
            "name": "Create Logging JSON",
            "description": null,
            "condition": "",
            "filterAgents": null,
            "postRun": "",
            "preRun": null,
            "coordination": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "615f0bb2f0c3640039eee24d",
                            "code": null,
                            "value": null,
                            "param": "61546d6e9cf4100039c59de8",
                            "name": "workingDir"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee24e",
                            "code": true,
                            "value": "enablebucketlogging()",
                            "param": "61546d6e9cf4100039c59de9",
                            "name": "COMMANDS"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee24f",
                            "code": null,
                            "value": null,
                            "param": "61546d6e9cf4100039c59dea",
                            "name": "exitOnClose"
                        }
                    ],
                    "name": "enablebucketlogging",
                    "timeout": null,
                    "method": "execute",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "CommandLine",
                "version": "1.2.0"
            },
            "uuid": "12480c19-03bc-4029-822e-eff15656a551",
            "numProcessParallel": null,
            "name": "Apply logging configuration",
            "description": null,
            "condition": "",
            "filterAgents": null,
            "postRun": "indexRemediate++;",
            "preRun": null,
            "coordination": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "60984a26d0f6e00034e4162a",
                            "code": null,
                            "value": "Slack Webhook",
                            "param": "605afc12257f0800340c6781",
                            "name": "webhookUrl"
                        },
                        {
                            "_id": "60984a26d0f6e00034e4162b",
                            "code": true,
                            "value": "sendslackmessageforignored()",
                            "param": "605afc12257f0800340c6782",
                            "name": "message"
                        }
                    ],
                    "name": "sendslackmessageforignored",
                    "timeout": null,
                    "method": "sendIncomingWebhook",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Slack",
                "version": "1.1.0"
            },
            "uuid": "96a251bd-04c4-49f8-8481-c081047efd3c",
            "numProcessParallel": null,
            "name": "Ignored",
            "description": null,
            "condition": "checkforignoredslack()",
            "filterAgents": null,
            "postRun": "indexIgnored++;",
            "preRun": null,
            "coordination": "each"
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "615f0bb2f0c3640039eee256",
                            "code": null,
                            "value": null,
                            "param": "61546d6e9cf4100039c59df1",
                            "name": "workingDir"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee257",
                            "code": true,
                            "value": "printTargetBucketName()",
                            "param": "61546d6e9cf4100039c59df2",
                            "name": "COMMANDS"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee258",
                            "code": null,
                            "value": null,
                            "param": "61546d6e9cf4100039c59df3",
                            "name": "exitOnClose"
                        }
                    ],
                    "name": "printTargetBucketName",
                    "timeout": null,
                    "method": "execute",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "CommandLine",
                "version": "1.2.0"
            },
            "uuid": "7a0088b7-fc77-4a82-90fd-56b5ddb7e540",
            "numProcessParallel": null,
            "name": "Print Target Bucket Name",
            "description": "only once for the target bucket that will be used.",
            "condition": "checkconditionforcli()",
            "coordination": "each",
            "filterAgents": null,
            "postRun": "",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "615f0bb2f0c3640039eee25b",
                            "code": true,
                            "value": "getawsaccesskeyfromvaultforremediation()",
                            "param": null,
                            "name": "AWS_ACCESS_KEY_ID"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee25c",
                            "code": true,
                            "value": "getawssecretkeyfromvaultforremediation()",
                            "param": null,
                            "name": "AWS_SECRET_ACCESS_KEY"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee25d",
                            "code": true,
                            "value": "getbucketname()",
                            "param": null,
                            "name": "bucketName"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee25e",
                            "code": null,
                            "value": null,
                            "param": null,
                            "name": "disableLogging"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee25f",
                            "code": true,
                            "value": "getTargetBucketName()",
                            "param": null,
                            "name": "targetBucket"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee260",
                            "code": null,
                            "value": "MyBucketLogs/",
                            "param": null,
                            "name": "targetPrefix"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee261",
                            "code": null,
                            "value": "WRITE",
                            "param": null,
                            "name": "permissionType"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee262",
                            "code": null,
                            "value": "http://acs.amazonaws.com/groups/s3/LogDelivery",
                            "param": null,
                            "name": "groupUris"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee263",
                            "code": null,
                            "value": null,
                            "param": null,
                            "name": "userIds"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee264",
                            "code": null,
                            "value": null,
                            "param": null,
                            "name": "emails"
                        }
                    ],
                    "name": "enablebucketlogging",
                    "timeout": null,
                    "method": "putBucketLogging",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Amazon-aws-s3",
                "version": "1.5.4"
            },
            "uuid": "00638c51-678d-4f2b-b3aa-66abffa87945",
            "numProcessParallel": null,
            "name": "Apply logging configuration",
            "description": null,
            "condition": "checkconditionfordapplyloggingviaobject()",
            "filterAgents": null,
            "postRun": "indexRemediate++;",
            "preRun": null,
            "coordination": "each"
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "60984a26d0f6e00034e4163f",
                            "code": true,
                            "value": "getawsaccountid()",
                            "param": null,
                            "name": "AWS_ACCOUNT_ID"
                        },
                        {
                            "_id": "60984a26d0f6e00034e41640",
                            "code": true,
                            "value": "getreporttype()",
                            "param": null,
                            "name": "REPORT_TYPE"
                        }
                    ],
                    "name": "getreportdetails",
                    "timeout": null,
                    "method": "GetLatestAWSComplianceReportDetails",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "lacework",
                "version": "1.2.0"
            },
            "uuid": "a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a",
            "numProcessParallel": null,
            "name": "Get report details",
            "description": null,
            "condition": "checkconfigurationforreport()",
            "coordination": null,
            "filterAgents": null,
            "postRun": "createBucketListfromReport()",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "60984a26d0f6e00034e41643",
                            "code": true,
                            "value": "getawsaccesskeyfromvaultfortag()",
                            "param": null,
                            "name": "accessKeyId"
                        },
                        {
                            "_id": "60984a26d0f6e00034e41644",
                            "code": true,
                            "value": "getawssecretkeyfromvaultfortag()",
                            "param": null,
                            "name": "secretAccesKey"
                        },
                        {
                            "_id": "60984a26d0f6e00034e41645",
                            "code": null,
                            "value": {
                                "id": "eu-central-1",
                                "value": "EU (Frankfurt)"
                            },
                            "param": null,
                            "name": "region"
                        },
                        {
                            "_id": "60984a26d0f6e00034e41646",
                            "code": true,
                            "value": "getbucketnameforobject()",
                            "param": null,
                            "name": "resourcesArn"
                        },
                        {
                            "_id": "60984a26d0f6e00034e41647",
                            "code": true,
                            "value": "getbuckettagsforobject()",
                            "param": null,
                            "name": "tags"
                        }
                    ],
                    "name": "puttag",
                    "timeout": null,
                    "method": "tagResources",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "AWS-resource-groups-tagging",
                "version": "1.1.0"
            },
            "uuid": "47b0f78e-033e-4f12-87f9-d1139fddf79f",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Put Bucket Tags via Object",
            "description": null,
            "condition": "checkputbuckettagsviaobject()",
            "filterAgents": null,
            "postRun": "indexTag++;",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "60984a26d0f6e00034e4164a",
                            "code": true,
                            "value": "putbuckettagging()",
                            "param": null,
                            "name": "COMMANDS"
                        }
                    ],
                    "name": "putbuckettagging",
                    "timeout": null,
                    "method": "execute",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "CommandLine",
                "version": "1.2.0"
            },
            "uuid": "41e6f934-3a9c-44a7-8de3-f6d77f0f4259",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Put Bucket Tags via CLI",
            "description": null,
            "condition": "checkputbuckettagsviacli()",
            "filterAgents": null,
            "postRun": "indexTag++;",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "612663b0acb7e500f684225c",
                            "code": true,
                            "value": "getrecommendationID()",
                            "param": null,
                            "name": "REC_ID"
                        }
                    ],
                    "name": "getcurrentsuppressionconfiguration",
                    "timeout": null,
                    "method": "GetAWSSuppressionforarecommendationID",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "lacework",
                "version": "1.2.3"
            },
            "uuid": "5dd89842-a6c2-4615-badd-ae2301c62d9b",
            "coordination": "race",
            "numProcessParallel": null,
            "name": "Get current suppression configuration",
            "description": "Check the current suppression configuration.",
            "condition": "checksuppressionconfiguration()",
            "filterAgents": null,
            "postRun": "createcurrentsuppressionsetting()",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": false,
            "mandatory": false,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "612663b0acb7e500f684225f",
                            "code": true,
                            "value": "getrecommendationIDforSuppression()",
                            "param": null,
                            "name": "REC_ID"
                        },
                        {
                            "_id": "612663b0acb7e500f6842260",
                            "code": true,
                            "value": "getTagKeyforSuppression()",
                            "param": null,
                            "name": "TAG_KEY"
                        },
                        {
                            "_id": "612663b0acb7e500f6842261",
                            "code": true,
                            "value": "getTagValueforSuppression()",
                            "param": null,
                            "name": "TAG_VALUE"
                        },
                        {
                            "_id": "612663b0acb7e500f6842262",
                            "code": true,
                            "value": "getsuppressionpolicycommentforSuppression()",
                            "param": null,
                            "name": "SUPPRESSION_COMMENT"
                        }
                    ],
                    "name": "Set Suppression Configuration",
                    "timeout": null,
                    "method": "ConfigureSuppressionviaTagforAWS",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "lacework",
                "version": "1.2.3"
            },
            "uuid": "a6e2c456-98d3-40a4-b5dd-e6801825a54f",
            "numProcessParallel": null,
            "name": "Configure Suppression via Tags",
            "description": null,
            "condition": "checksuppressionneedstobeconfigured()",
            "coordination": null,
            "filterAgents": null,
            "postRun": null,
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "615f0bb2f0c3640039eee27e",
                            "code": null,
                            "value": null,
                            "param": "61546d6e9cf4100039c59e19",
                            "name": "workingDir"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee27f",
                            "code": true,
                            "value": "putbucketacl()",
                            "param": "61546d6e9cf4100039c59e1a",
                            "name": "COMMANDS"
                        },
                        {
                            "_id": "615f0bb2f0c3640039eee280",
                            "code": null,
                            "value": null,
                            "param": "61546d6e9cf4100039c59e1b",
                            "name": "exitOnClose"
                        }
                    ],
                    "name": "putbucketacl",
                    "timeout": null,
                    "method": "execute",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "CommandLine",
                "version": "2.0.1"
            },
            "uuid": "76005fdf-5c0b-4f51-9c71-e621caecb237",
            "numProcessParallel": null,
            "name": "Change Target Bucket ACL via CLI",
            "description": "only once for the target bucket that will be used.",
            "condition": null,
            "coordination": null,
            "filterAgents": null,
            "postRun": null,
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "name": null,
                    "timeout": null,
                    "retries": 0,
                    "method": "sendIncomingWebhook",
                    "mandatory": null,
                    "params": [
                        {
                            "code": null,
                            "value": "Slack Webhook",
                            "param": "615ef98ff0c3640039eeac38",
                            "viewName": "Webhook URL",
                            "name": "webhookUrl",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "sendstatistics()",
                            "param": "615ef98ff0c3640039eeac39",
                            "viewName": "Message (string, object)",
                            "name": "message",
                            "type": "string",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Slack",
                "version": "1.1.0"
            },
            "uuid": "770434ba-6231-4a24-9b4e-7e1e14cedf91",
            "coordination": "race",
            "numProcessParallel": null,
            "name": "Send Statistics",
            "description": "Send information about total number of S3 buckets that will be remediated, ignored and that are configured to be ignored.",
            "condition": "checkslackstatistics()",
            "filterAgents": null,
            "postRun": null,
            "preRun": null
        }
    ],
    "links": [
        {
            "uuid": "399a889b-a732-465a-9c9d-c4d8de7d768f",
            "sourceId": "de515060-723d-4c12-92e4-f1bef9157748",
            "targetId": "42bb48ed-ae0a-4093-854d-2dc6777f618d"
        },
        {
            "uuid": "d2a4c623-ff5b-480c-936e-4858072368c0",
            "sourceId": "6c03b7c3-3646-42f2-ab0e-96989cd3dfae",
            "targetId": "6c03b7c3-3646-42f2-ab0e-96989cd3dfae"
        },
        {
            "uuid": "20daaf00-9ef1-47d3-8ad4-1c0dfeeeb766",
            "sourceId": "d78986e7-d694-43d3-84de-81cd5b8fa2f6",
            "targetId": "af4fd499-20e7-40bd-8cb3-97fb9cf86be4"
        },
        {
            "uuid": "d47cc231-ef2a-447e-ae5d-f5eb57f5c080",
            "sourceId": "af4fd499-20e7-40bd-8cb3-97fb9cf86be4",
            "targetId": "12480c19-03bc-4029-822e-eff15656a551"
        },
        {
            "uuid": "2ad0a351-0a2e-471f-8be4-9316b61d7cdd",
            "sourceId": "96a251bd-04c4-49f8-8481-c081047efd3c",
            "targetId": "96a251bd-04c4-49f8-8481-c081047efd3c"
        },
        {
            "uuid": "fc5b4365-8a51-4822-ae47-1ae2bfb18fa2",
            "sourceId": "42bb48ed-ae0a-4093-854d-2dc6777f618d",
            "targetId": "7a0088b7-fc77-4a82-90fd-56b5ddb7e540"
        },
        {
            "uuid": "eb439b9b-e02b-4d0b-84b0-5508a9b67b72",
            "sourceId": "42bb48ed-ae0a-4093-854d-2dc6777f618d",
            "targetId": "6c03b7c3-3646-42f2-ab0e-96989cd3dfae"
        },
        {
            "uuid": "db6b1a47-94ff-4f1a-a656-61202c105f5b",
            "sourceId": "42bb48ed-ae0a-4093-854d-2dc6777f618d",
            "targetId": "83725c35-de1b-4c04-81e5-32dd242852b4"
        },
        {
            "uuid": "86fcd9c3-4f31-418d-94c4-0a2be0e5ef01",
            "sourceId": "83725c35-de1b-4c04-81e5-32dd242852b4",
            "targetId": "00638c51-678d-4f2b-b3aa-66abffa87945"
        },
        {
            "uuid": "62579626-dc5f-4d8e-bd09-025053c632cf",
            "sourceId": "de515060-723d-4c12-92e4-f1bef9157748",
            "targetId": "a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a"
        },
        {
            "uuid": "24032e27-9406-4518-b10d-f61eaf524601",
            "sourceId": "a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a",
            "targetId": "7a0088b7-fc77-4a82-90fd-56b5ddb7e540"
        },
        {
            "uuid": "40b7d994-747f-4804-9d4a-2ac03b6eafbd",
            "sourceId": "a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a",
            "targetId": "83725c35-de1b-4c04-81e5-32dd242852b4"
        },
        {
            "uuid": "a623c98f-0ada-42ff-87c0-0a07df5032c0",
            "sourceId": "a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a",
            "targetId": "6c03b7c3-3646-42f2-ab0e-96989cd3dfae"
        },
        {
            "uuid": "2b49de0a-afd0-417f-b109-e7f3d3e6e55c",
            "sourceId": "42bb48ed-ae0a-4093-854d-2dc6777f618d",
            "targetId": "96a251bd-04c4-49f8-8481-c081047efd3c"
        },
        {
            "uuid": "8b27dc29-9db6-4b58-982f-ab50fb391f85",
            "sourceId": "a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a",
            "targetId": "96a251bd-04c4-49f8-8481-c081047efd3c"
        },
        {
            "uuid": "186159cd-8755-455a-a7e5-66ca6a420746",
            "sourceId": "47b0f78e-033e-4f12-87f9-d1139fddf79f",
            "targetId": "47b0f78e-033e-4f12-87f9-d1139fddf79f"
        },
        {
            "uuid": "eeb81cc4-9358-4c8c-8b67-432634b08c70",
            "sourceId": "41e6f934-3a9c-44a7-8de3-f6d77f0f4259",
            "targetId": "41e6f934-3a9c-44a7-8de3-f6d77f0f4259"
        },
        {
            "uuid": "f3f49413-31b9-4c07-88fb-346ca9d50b75",
            "sourceId": "42bb48ed-ae0a-4093-854d-2dc6777f618d",
            "targetId": "47b0f78e-033e-4f12-87f9-d1139fddf79f"
        },
        {
            "uuid": "9a815306-7d2f-452e-95c0-f58599069047",
            "sourceId": "a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a",
            "targetId": "47b0f78e-033e-4f12-87f9-d1139fddf79f"
        },
        {
            "uuid": "83db2351-ffaf-4a4e-9d82-ca94cae39193",
            "sourceId": "42bb48ed-ae0a-4093-854d-2dc6777f618d",
            "targetId": "41e6f934-3a9c-44a7-8de3-f6d77f0f4259"
        },
        {
            "uuid": "0411a12b-1400-478e-aae9-74c1959a6579",
            "sourceId": "a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a",
            "targetId": "41e6f934-3a9c-44a7-8de3-f6d77f0f4259"
        },
        {
            "uuid": "74969ff1-661f-44c2-b617-346747c8dff8",
            "sourceId": "42bb48ed-ae0a-4093-854d-2dc6777f618d",
            "targetId": "5dd89842-a6c2-4615-badd-ae2301c62d9b"
        },
        {
            "uuid": "c5f13ea7-b95b-4dd2-ac6d-5b68bda6cf00",
            "sourceId": "a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a",
            "targetId": "5dd89842-a6c2-4615-badd-ae2301c62d9b"
        },
        {
            "uuid": "181347a3-02c5-43fa-81b2-a7627e129a4b",
            "sourceId": "5dd89842-a6c2-4615-badd-ae2301c62d9b",
            "targetId": "a6e2c456-98d3-40a4-b5dd-e6801825a54f"
        },
        {
            "uuid": "8272cf76-9c48-4dea-b325-fee85a017f92",
            "sourceId": "76005fdf-5c0b-4f51-9c71-e621caecb237",
            "targetId": "d78986e7-d694-43d3-84de-81cd5b8fa2f6"
        },
        {
            "uuid": "16299652-a3bb-437d-a404-3b60c5b9219c",
            "sourceId": "7a0088b7-fc77-4a82-90fd-56b5ddb7e540",
            "targetId": "76005fdf-5c0b-4f51-9c71-e621caecb237"
        },
        {
            "uuid": "0f23ca5b-24c3-4ce7-99ef-c4c548d4be55",
            "sourceId": "42bb48ed-ae0a-4093-854d-2dc6777f618d",
            "targetId": "770434ba-6231-4a24-9b4e-7e1e14cedf91"
        },
        {
            "uuid": "4ead4bc6-cbfb-4c56-8444-dd68ece99b4d",
            "sourceId": "a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a",
            "targetId": "770434ba-6231-4a24-9b4e-7e1e14cedf91"
        },
        {
            "uuid": "e34b00ff-8fbe-4f08-8a28-c1e6647cddc9",
            "sourceId": "12480c19-03bc-4029-822e-eff15656a551",
            "targetId": "d78986e7-d694-43d3-84de-81cd5b8fa2f6"
        },
        {
            "uuid": "c19907a3-7aba-4a37-8d6e-8fffcdfe67b1",
            "sourceId": "00638c51-678d-4f2b-b3aa-66abffa87945",
            "targetId": "00638c51-678d-4f2b-b3aa-66abffa87945"
        }
    ],
    "content": "{\"cells\":[{\"type\":\"devs.PMStartPoint\",\"size\":{\"width\":40,\"height\":39},\"outPorts\":[\" \"],\"inPorts\":[],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\" \"}}}]},\"position\":{\"x\":50,\"y\":20},\"angle\":0,\"id\":\"de515060-723d-4c12-92e4-f1bef9157748\",\"z\":1,\"attrs\":{\"rect\":{\"fill\":\"#2d3236\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":183,\"y\":-103},\"angle\":0,\"id\":\"42bb48ed-ae0a-4093-854d-2dc6777f618d\",\"z\":2,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Get event details\"},\".p_id\":{\"text\":\"60ec2ebeacb7e500f63e9f36\"},\"image\":{\"xlink:href\":\"/plugins/lacework/lacework.png\",\"ref-y\":50},\"text\":{\"text\":\"Get event details\"}}},{\"type\":\"link\",\"source\":{\"id\":\"de515060-723d-4c12-92e4-f1bef9157748\",\"port\":\" \"},\"target\":{\"id\":\"42bb48ed-ae0a-4093-854d-2dc6777f618d\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"399a889b-a732-465a-9c9d-c4d8de7d768f\",\"z\":3,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":787,\"y\":-181},\"angle\":0,\"id\":\"d78986e7-d694-43d3-84de-81cd5b8fa2f6\",\"z\":4,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Enable Bucket Logging via CLI\"},\".p_id\":{\"text\":\"60ec31a0acb7e500f63ea119\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Enable Bucket Logging via CLI\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":773,\"y\":36},\"angle\":0,\"id\":\"6c03b7c3-3646-42f2-ab0e-96989cd3dfae\",\"z\":7,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Remediated\"},\".p_id\":{\"text\":\"60ec2f8facb7e500f63e9f9b\"},\"image\":{\"xlink:href\":\"/plugins/Slack/Slack_Icon.png\",\"ref-y\":50},\"text\":{\"text\":\"Remediated\"}}},{\"type\":\"link\",\"source\":{\"id\":\"6c03b7c3-3646-42f2-ab0e-96989cd3dfae\",\"port\":\"  \"},\"target\":{\"id\":\"6c03b7c3-3646-42f2-ab0e-96989cd3dfae\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"d2a4c623-ff5b-480c-936e-4858072368c0\",\"z\":9,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":378,\"y\":237},\"angle\":0,\"id\":\"83725c35-de1b-4c04-81e5-32dd242852b4\",\"z\":10,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Change Target Bucket ACL via Object\"},\".p_id\":{\"text\":\"60ec30a5acb7e500f63ea02f\"},\"image\":{\"xlink:href\":\"/plugins/Amazon-aws-s3/logo.png\",\"ref-y\":50},\"text\":{\"text\":\"Change Target Bucket ACL via Object\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":981,\"y\":-181},\"angle\":0,\"id\":\"af4fd499-20e7-40bd-8cb3-97fb9cf86be4\",\"z\":11,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Create Logging JSON\"},\".p_id\":{\"text\":\"60ec2fbeacb7e500f63e9fc2\"},\"image\":{\"xlink:href\":\"/plugins/TextEditor/TextEditor.png\",\"ref-y\":50},\"text\":{\"text\":\"Create Logging JSON\"}}},{\"type\":\"link\",\"source\":{\"id\":\"d78986e7-d694-43d3-84de-81cd5b8fa2f6\",\"port\":\"  \"},\"target\":{\"id\":\"af4fd499-20e7-40bd-8cb3-97fb9cf86be4\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"20daaf00-9ef1-47d3-8ad4-1c0dfeeeb766\",\"z\":12,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":1166,\"y\":-187},\"angle\":0,\"id\":\"12480c19-03bc-4029-822e-eff15656a551\",\"z\":14,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Apply logging configuration\"},\".p_id\":{\"text\":\"60ec31a0acb7e500f63ea119\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Apply logging configuration\"}}},{\"type\":\"link\",\"source\":{\"id\":\"af4fd499-20e7-40bd-8cb3-97fb9cf86be4\",\"port\":\"  \"},\"target\":{\"id\":\"12480c19-03bc-4029-822e-eff15656a551\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"d47cc231-ef2a-447e-ae5d-f5eb57f5c080\",\"z\":16,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":973,\"y\":37},\"angle\":0,\"id\":\"96a251bd-04c4-49f8-8481-c081047efd3c\",\"z\":17,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Ignored\"},\".p_id\":{\"text\":\"60ec2f8facb7e500f63e9f9b\"},\"image\":{\"xlink:href\":\"/plugins/Slack/Slack_Icon.png\",\"ref-y\":50},\"text\":{\"text\":\"Ignored\"}}},{\"type\":\"link\",\"source\":{\"id\":\"96a251bd-04c4-49f8-8481-c081047efd3c\",\"port\":\"  \"},\"target\":{\"id\":\"96a251bd-04c4-49f8-8481-c081047efd3c\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"2ad0a351-0a2e-471f-8be4-9316b61d7cdd\",\"z\":19,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":348,\"y\":-180},\"angle\":0,\"id\":\"7a0088b7-fc77-4a82-90fd-56b5ddb7e540\",\"z\":20,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Print Target Bucket Name\"},\".p_id\":{\"text\":\"60ec31a0acb7e500f63ea119\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Print Target Bucket Name\"}}},{\"type\":\"link\",\"source\":{\"id\":\"42bb48ed-ae0a-4093-854d-2dc6777f618d\",\"port\":\"  \"},\"target\":{\"id\":\"7a0088b7-fc77-4a82-90fd-56b5ddb7e540\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"fc5b4365-8a51-4822-ae47-1ae2bfb18fa2\",\"z\":21,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"42bb48ed-ae0a-4093-854d-2dc6777f618d\",\"port\":\"  \"},\"target\":{\"id\":\"6c03b7c3-3646-42f2-ab0e-96989cd3dfae\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"eb439b9b-e02b-4d0b-84b0-5508a9b67b72\",\"z\":23,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"42bb48ed-ae0a-4093-854d-2dc6777f618d\",\"port\":\"  \"},\"target\":{\"id\":\"83725c35-de1b-4c04-81e5-32dd242852b4\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"db6b1a47-94ff-4f1a-a656-61202c105f5b\",\"z\":24,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":713,\"y\":237},\"angle\":0,\"id\":\"00638c51-678d-4f2b-b3aa-66abffa87945\",\"z\":25,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Apply logging configuration\"},\".p_id\":{\"text\":\"60ec30a5acb7e500f63ea02f\"},\"image\":{\"xlink:href\":\"/plugins/Amazon-aws-s3/logo.png\",\"ref-y\":50},\"text\":{\"text\":\"Apply logging configuration\"}}},{\"type\":\"link\",\"source\":{\"id\":\"83725c35-de1b-4c04-81e5-32dd242852b4\",\"port\":\"  \"},\"target\":{\"id\":\"00638c51-678d-4f2b-b3aa-66abffa87945\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"86fcd9c3-4f31-418d-94c4-0a2be0e5ef01\",\"z\":27,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":189,\"y\":133},\"angle\":0,\"id\":\"a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a\",\"z\":28,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Get report details\"},\".p_id\":{\"text\":\"60ec2ebeacb7e500f63e9f36\"},\"image\":{\"xlink:href\":\"/plugins/lacework/lacework.png\",\"ref-y\":50},\"text\":{\"text\":\"Get report details\"}}},{\"type\":\"link\",\"source\":{\"id\":\"de515060-723d-4c12-92e4-f1bef9157748\",\"port\":\" \"},\"target\":{\"id\":\"a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"62579626-dc5f-4d8e-bd09-025053c632cf\",\"z\":29,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a\",\"port\":\"  \"},\"target\":{\"id\":\"7a0088b7-fc77-4a82-90fd-56b5ddb7e540\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"24032e27-9406-4518-b10d-f61eaf524601\",\"z\":30,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a\",\"port\":\"  \"},\"target\":{\"id\":\"83725c35-de1b-4c04-81e5-32dd242852b4\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"40b7d994-747f-4804-9d4a-2ac03b6eafbd\",\"z\":31,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a\",\"port\":\"  \"},\"target\":{\"id\":\"6c03b7c3-3646-42f2-ab0e-96989cd3dfae\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"a623c98f-0ada-42ff-87c0-0a07df5032c0\",\"z\":32,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"42bb48ed-ae0a-4093-854d-2dc6777f618d\",\"port\":\"  \"},\"target\":{\"id\":\"96a251bd-04c4-49f8-8481-c081047efd3c\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"2b49de0a-afd0-417f-b109-e7f3d3e6e55c\",\"z\":33,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a\",\"port\":\"  \"},\"target\":{\"id\":\"96a251bd-04c4-49f8-8481-c081047efd3c\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"8b27dc29-9db6-4b58-982f-ab50fb391f85\",\"z\":34,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":409,\"y\":34},\"angle\":0,\"id\":\"47b0f78e-033e-4f12-87f9-d1139fddf79f\",\"z\":35,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Put Bucket Tags via Object\"},\".p_id\":{\"text\":\"60ec30d1acb7e500f63ea0b6\"},\"image\":{\"xlink:href\":\"/plugins/AWS-resource-groups-tagging/logo.png\",\"ref-y\":50},\"text\":{\"text\":\"Put Bucket Tags via Object\"}}},{\"type\":\"link\",\"source\":{\"id\":\"47b0f78e-033e-4f12-87f9-d1139fddf79f\",\"port\":\"  \"},\"target\":{\"id\":\"47b0f78e-033e-4f12-87f9-d1139fddf79f\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"186159cd-8755-455a-a7e5-66ca6a420746\",\"z\":36,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":592,\"y\":37},\"angle\":0,\"id\":\"41e6f934-3a9c-44a7-8de3-f6d77f0f4259\",\"z\":37,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Put Bucket Tags via CLI\"},\".p_id\":{\"text\":\"60ec31a0acb7e500f63ea119\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Put Bucket Tags via CLI\"}}},{\"type\":\"link\",\"source\":{\"id\":\"41e6f934-3a9c-44a7-8de3-f6d77f0f4259\",\"port\":\"  \"},\"target\":{\"id\":\"41e6f934-3a9c-44a7-8de3-f6d77f0f4259\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"eeb81cc4-9358-4c8c-8b67-432634b08c70\",\"z\":38,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"42bb48ed-ae0a-4093-854d-2dc6777f618d\",\"port\":\"  \"},\"target\":{\"id\":\"47b0f78e-033e-4f12-87f9-d1139fddf79f\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"f3f49413-31b9-4c07-88fb-346ca9d50b75\",\"z\":39,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a\",\"port\":\"  \"},\"target\":{\"id\":\"47b0f78e-033e-4f12-87f9-d1139fddf79f\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"9a815306-7d2f-452e-95c0-f58599069047\",\"z\":40,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"42bb48ed-ae0a-4093-854d-2dc6777f618d\",\"port\":\"  \"},\"target\":{\"id\":\"41e6f934-3a9c-44a7-8de3-f6d77f0f4259\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"83db2351-ffaf-4a4e-9d82-ca94cae39193\",\"z\":41,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a\",\"port\":\"  \"},\"target\":{\"id\":\"41e6f934-3a9c-44a7-8de3-f6d77f0f4259\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"0411a12b-1400-478e-aae9-74c1959a6579\",\"z\":42,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":332,\"y\":363},\"angle\":0,\"id\":\"5dd89842-a6c2-4615-badd-ae2301c62d9b\",\"z\":43,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Get current suppression configuration\"},\".p_id\":{\"text\":\"60ec2ebeacb7e500f63e9f36\"},\"image\":{\"xlink:href\":\"/plugins/lacework/lacework.png\",\"ref-y\":50},\"text\":{\"text\":\"Get current suppression configuration\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":614,\"y\":363},\"angle\":0,\"id\":\"a6e2c456-98d3-40a4-b5dd-e6801825a54f\",\"z\":44,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Configure Suppression via Tags\"},\".p_id\":{\"text\":\"60ec2ebeacb7e500f63e9f36\"},\"image\":{\"xlink:href\":\"/plugins/lacework/lacework.png\",\"ref-y\":50},\"text\":{\"text\":\"Configure Suppression via Tags\"}}},{\"type\":\"link\",\"source\":{\"id\":\"42bb48ed-ae0a-4093-854d-2dc6777f618d\",\"port\":\"  \"},\"target\":{\"id\":\"5dd89842-a6c2-4615-badd-ae2301c62d9b\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"74969ff1-661f-44c2-b617-346747c8dff8\",\"z\":45,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a\",\"port\":\"  \"},\"target\":{\"id\":\"5dd89842-a6c2-4615-badd-ae2301c62d9b\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"c5f13ea7-b95b-4dd2-ac6d-5b68bda6cf00\",\"z\":46,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"5dd89842-a6c2-4615-badd-ae2301c62d9b\",\"port\":\"  \"},\"target\":{\"id\":\"a6e2c456-98d3-40a4-b5dd-e6801825a54f\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"181347a3-02c5-43fa-81b2-a7627e129a4b\",\"z\":47,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":572,\"y\":-181},\"angle\":0,\"id\":\"76005fdf-5c0b-4f51-9c71-e621caecb237\",\"z\":48,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Change Target Bucket ACL via CLI\"},\".p_id\":{\"text\":\"60ec31a0acb7e500f63ea119\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Change Target Bucket ACL via CLI\"}}},{\"type\":\"link\",\"source\":{\"id\":\"76005fdf-5c0b-4f51-9c71-e621caecb237\",\"port\":\"  \"},\"target\":{\"id\":\"d78986e7-d694-43d3-84de-81cd5b8fa2f6\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"8272cf76-9c48-4dea-b325-fee85a017f92\",\"z\":49,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"7a0088b7-fc77-4a82-90fd-56b5ddb7e540\",\"port\":\"  \"},\"target\":{\"id\":\"76005fdf-5c0b-4f51-9c71-e621caecb237\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"16299652-a3bb-437d-a404-3b60c5b9219c\",\"z\":50,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":1145,\"y\":34},\"angle\":0,\"id\":\"770434ba-6231-4a24-9b4e-7e1e14cedf91\",\"z\":53,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Send Statistics\"},\".p_id\":{\"text\":\"60ec2f8facb7e500f63e9f9b\"},\"image\":{\"xlink:href\":\"/plugins/Slack/Slack_Icon.png\",\"ref-y\":50},\"text\":{\"text\":\"Send Statistics\"}}},{\"type\":\"link\",\"source\":{\"id\":\"42bb48ed-ae0a-4093-854d-2dc6777f618d\",\"port\":\"  \"},\"target\":{\"id\":\"770434ba-6231-4a24-9b4e-7e1e14cedf91\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"0f23ca5b-24c3-4ce7-99ef-c4c548d4be55\",\"z\":54,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"a6d14793-6dd4-4d22-8cc8-9d49edd6fd2a\",\"port\":\"  \"},\"target\":{\"id\":\"770434ba-6231-4a24-9b4e-7e1e14cedf91\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"4ead4bc6-cbfb-4c56-8444-dd68ece99b4d\",\"z\":55,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"12480c19-03bc-4029-822e-eff15656a551\",\"port\":\"  \"},\"target\":{\"id\":\"d78986e7-d694-43d3-84de-81cd5b8fa2f6\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"e34b00ff-8fbe-4f08-8a28-c1e6647cddc9\",\"z\":56,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"00638c51-678d-4f2b-b3aa-66abffa87945\",\"port\":\"  \"},\"target\":{\"id\":\"00638c51-678d-4f2b-b3aa-66abffa87945\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"c19907a3-7aba-4a37-8d6e-8fffcdfe67b1\",\"z\":57,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}}]}",
    "used_plugins": [
        {
            "name": "lacework",
            "version": "1.0.0"
        },
        {
            "name": "CommandLine",
            "version": "1.2.0"
        },
        {
            "name": "Slack",
            "version": "1.1.0"
        },
        {
            "name": "Amazon-aws-s3",
            "version": "1.5.4"
        },
        {
            "name": "TextEditor",
            "version": "1.0.0"
        },
        {
            "name": "CommandLine",
            "version": "1.2.0"
        },
        {
            "name": "Slack",
            "version": "1.1.0"
        },
        {
            "name": "CommandLine",
            "version": "1.2.0"
        },
        {
            "name": "Amazon-aws-s3",
            "version": "1.5.4"
        },
        {
            "name": "lacework",
            "version": "1.2.0"
        },
        {
            "name": "AWS-resource-groups-tagging",
            "version": "1.1.0"
        },
        {
            "name": "CommandLine",
            "version": "1.2.0"
        },
        {
            "name": "lacework",
            "version": "1.2.3"
        },
        {
            "name": "lacework",
            "version": "1.2.3"
        },
        {
            "name": "CommandLine",
            "version": "2.0.1"
        },
        {
            "name": "Slack",
            "version": "1.1.0"
        }
    ],
    "__v": 0,
    "code": "// Default variables for this Map\nvar bucketArr = []; // Array of S3 Buckets that will be used for the Auto Remediation.\nvar indexRemediate = 0; // Index for the S3 Bucket Auto Remediation Lopps of the Map.\nvar indexSlack = 0; // Index of the Slack Loop of the map to send out information about the S3 Buckets that will be used for Auto Remediation.\nvar bucketIgnoredArr = []; // Array of S3 Buckets that are violating but will be ignored based in the bucketIgnoreList list in the configuration.\nvar indexIgnored = 0; //Index of the S3 Buckets for slack loop that are violating but will be ignored.\nvar indexTag = 0; // Index for setting tags for the ignored S3 buckets so they will be suppressed after the next compliance check.\nlet payload = trigger.payload; // The Payload that was send by the Webhook Trigger. Information about the Payload is available at https://support.lacework.com/hc/en-us/articles/360034367393-Webhook\nvar link; // Link used for Slack messages to send out about the event and report.\nvar event_aws_accountid; // AWS Account ID for the Event or the Report against it will run the CLI commands or Objects. Will be read out from the Event itself.\nvar event_aws_account_key; // AWS Account Key variable to get the value from the vault.\nvar event_aws_secret_key; // AWS Secret Key variable to get the value from the vault.\nvar suppressionTag; //Variable with the current Tag Name\nvar suppressionValue; //Variables with the current Tag Value\nvar bucketArrLength; // Number of S3 buckets that will be remediated.\nvar bucketIgnoredArrLength; // Number of S3 buckets that will be ignored.\nvar bucketConfiguredIgnoredArrLength; // Number of S3 buckets that are configured to be ignored.\nvar resourcesArrLength; //Total number of resources that are violating the compliance rule.\n\n// Object \"Get event details\" functions:\nfunction checkconfigurationforevent() { // Function to check if CLI and Object remediation is enabled and if a Payload is send via the Webhook.\n    if (configuration.dotheremediationviacli == \"true\" && configuration.dotheremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (payload !== null) // Don't try to get the Events if the payload is not defined.\n    {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction createBucketList() { // Function to build the S3 Bucket List that will be used for Auto Remediation.\n    let p = configuration.eventuuid;\n    let laceworkAPIResult = getAction(p);\n    link = payload.event_link;\n    if (laceworkAPIResult.result.result.data[0].ENTITY_MAP.ViolationReason[0].REC_ID == configuration.rec_id) {\n        event_aws_accountid = laceworkAPIResult.result.result.data[0].ENTITY_MAP.RecId[0].ACCOUNT_ID;\n        event_aws_account_key = event_aws_accountid;\n        event_aws_account_key += \"_aws_access_key_id\";\n        event_aws_secret_key = event_aws_accountid;\n        event_aws_secret_key += \"_aws_secret_access_key\";\n        if (configuration.autoremediationonlyfornewviolations == \"true\")\n        {\n            let resourcesArr = laceworkAPIResult.result.result.data[0].ENTITY_MAP.NewViolation;\n            for (let i = 0; i < resourcesArr.length; i++) {\n            if (!configuration.bucketIgnoreList.includes(resourcesArr[i].RESOURCE)) { // The S3 Bucket of the Event will be checked against the configuration list of to ignore S3 buckets.\n                bucketArr.push(resourcesArr[i].RESOURCE); // If the bucket is not on the list it will be pushed into the array.\n            }\n            else {\n                bucketIgnoredArr.push(resourcesArr[i].RESOURCE); // If the bucket is on the list and violating the policy it will be pushed into the second bucket list.\n            }\n            resourcesArrLength = resourcesArr.length;\n        }\n        }\n        else\n        {\n            let resourcesArr = laceworkAPIResult.result.result.data[0].ENTITY_MAP.Resource;\n            for (let i = 0; i < resourcesArr.length; i++) {\n            if (!configuration.bucketIgnoreList.includes(resourcesArr[i].VALUE)) { // The S3 Bucket of the Event will be checked against the configuration list of to ignore S3 buckets.\n                bucketArr.push(resourcesArr[i].VALUE); // If the bucket is not on the list it will be pushed into the array.\n            }\n            else {\n                bucketIgnoredArr.push(resourcesArr[i].VALUE); // If the bucket is on the list and violating the policy it will be pushed into the second bucket list.\n            }\n            resourcesArrLength = resourcesArr.length;\n        }\n        }\n        bucketArrLength = bucketArr.length;\n        bucketIgnoredArrLength = bucketIgnoredArr.length;\n        bucketConfiguredIgnoredArrLength = configuration.bucketIgnoreList.length;\n    }\n}\n\nfunction geteventid() { // Function to get the Event ID from the Webhook Payload.\n    return `${payload.event_id}`;\n}\n\n// Object \"Get report details\" functions:\nfunction checkconfigurationforreport() { // Function to check if CLI and Object Auto Remediation is enabled. Also check if it is not triggered via a Webhook with a payload send.\n    if (configuration.dotheremediationviacli == \"true\" && configuration.dotheremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (payload == null) // Only trigger the Report collection if there is no payload defined.\n    {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction createBucketListfromReport() { // Function to build the S3 Bucket List that will be used to Remediate.\n    let p = configuration.reportuuid;\n    let laceworkAPIResult = getAction(p);\n    let findreason = 0;\n    let recommendationsArr = laceworkAPIResult.result.result.data[0].recommendations;\n    for (let i = 0; i < recommendationsArr.length; i++) {\n        if (recommendationsArr[i].REC_ID == configuration.rec_id) {\n            link = recommendationsArr[i].INFO_LINK;\n            findreason = i;\n        }\n        else {\n            // Didn't found the right reason\n        }\n    }\n    let resourcesArr = laceworkAPIResult.result.result.data[0].recommendations[findreason].VIOLATIONS;\n    resourcesArrLength = resourcesArr.length;\n    event_aws_accountid = configuration.awsaccountid;\n    event_aws_account_key = event_aws_accountid;\n    event_aws_account_key += \"_aws_access_key_id\";\n    event_aws_secret_key = event_aws_accountid;\n    event_aws_secret_key += \"_aws_secret_access_key\";\n    for (let i = 0; i < resourcesArr.length; i++) {\n        if (!configuration.bucketIgnoreList.includes(resourcesArr[i].resource)) { // The S3 Bucket of the Event will be checked against the configuration list of to ignore S3 buckets.\n            bucketArr.push(resourcesArr[i].resource); // If the bucket is not on the list it will be pushed into the array.\n        }\n        else {\n            bucketIgnoredArr.push(resourcesArr[i].resource); // If the bucket is on the list and violating the policy it will be pushed into the second bucket list.\n        }\n    }\n    bucketArrLength = bucketArr.length;\n    bucketIgnoredArrLength = bucketIgnoredArr.length;\n    bucketConfiguredIgnoredArrLength = configuration.bucketIgnoreList.length;\n}\n\nfunction getawsaccountid() {\n    return `${configuration.awsaccountid}`;\n}\n\nfunction getreporttype() {\n    return `${configuration.reporttype}`;\n}\n\n// Object \"Put Bucket Tags via CLI\" functions:\nfunction checkputbuckettagsviacli() { //Check if AWS Tags should be added to the S3 bucket.\n   if (configuration.putbuckettaggingviacli == \"true\") {\n        if (indexTag < bucketIgnoredArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction putbuckettagging(){ // Put the S3 Bucket tags for suppression.\n    let bucket = bucketIgnoredArr[indexTag];\n    return `aws resourcegroupstaggingapi tag-resources --resource-arn-list ${bucketIgnoredArr[indexTag]} --tags ${configuration.tagname}=${configuration.tagvalue} --profile ${event_aws_accountid}` ; //Using the put-bucket-tagging to create the tags of the S3 buckets\n}\n\n// Object \"Put Bucket Tags via Object\" functions:\nfunction checkputbuckettagsviaobject() { // Check if AWS Tags should be added to the S3 bucket.\n   if (configuration.putbuckettaggingviaobject == \"true\") {\n        if (indexTag < bucketIgnoredArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction getawsaccesskeyfromvaultfortag() { // Get the right AWS Access Key from the Vault\n    let aws_access_key = useKey(event_aws_account_key);\n    return aws_access_key; \n}\n\nfunction getawssecretkeyfromvaultfortag() { // Get the right AWS Secret Key from the Vault\n    let aws_secret_key = useKey(event_aws_secret_key);\n    return aws_secret_key; \n}\n\nfunction getbucketnameforobject() { // Get the S3 Bucket Name for the Tag Resource Object.\n    let bucket = bucketIgnoredArr[indexTag];\n    return `${bucket}`; \n}\n\nfunction getbuckettagsforobject() { // Get the tag and tag value that will be put on the S3 bucket.\n    return `${configuration.tagname}=${configuration.tagvalue}`;\n}\n\n// Object \"Change Target Bucket ACL via Object\" functions:\nfunction checkremediationviaobject() //Check if the Remedation should be done via the Object?\n{\n    if (configuration.enablebucketloggingviaobject == \"true\") {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction getawsaccesskeyfromvaultforremediation() { // Get the right AWS Access Key from the Vault\n    let aws_access_key = useKey(event_aws_account_key);\n    return aws_access_key; \n}\n\nfunction getawssecretkeyfromvaultforremediation() { // Get the right AWS Secret Key from the Vault\n    let aws_secret_key = useKey(event_aws_secret_key);\n    return aws_secret_key; \n}\n\n\nfunction getTargetBucketName() { // Function to print the S3 buckets that will be used as Target Bucket for logging.\n    return `${configuration.loggingconfiguration.LoggingEnabled.TargetBucket}`;\n}\n\n// Object \"Apply logging configuration\" functions:\nfunction checkconditionfordapplyloggingviaobject() { //Function to check if logging should be applied.\n    if (configuration.enablebucketloggingviaobject == \"true\") {\n        if (indexRemediate < bucketArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\n\n\nfunction getbucketname() { // Function to print the S3 buckets that will be remediated.\n    let bucket = bucketArr[indexRemediate]\n    let arr = bucket.split(\":::\")\n    return `${arr[arr.length-1]}`;\n}\n\n// Object \"Change Target Bucket ACL via CLI\" functions:\nfunction checkconditionforcli()\n{\n    if (configuration.enablebucketloggingviacli == \"true\") {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction printTargetBucketName() { // Function to print the S3 buckets that will be used as Target Bucket for logging.\n    return `echo Target Bucket for Logging ${configuration.loggingconfiguration.LoggingEnabled.TargetBucket} needs to be prepared.`;\n}\n\nfunction putbucketacl() { // Put the right Bucket ACL on the Target S3 Bucket for logging before applying the bucket logging\n    return `aws s3api put-bucket-acl --bucket ${configuration.loggingconfiguration.LoggingEnabled.TargetBucket} --grant-write URI=http://acs.amazonaws.com/groups/s3/LogDelivery --grant-read-acp URI=http://acs.amazonaws.com/groups/s3/LogDelivery`; // Using the put-bucket-acl to configure the Target Bucket correctly.\n}\n\n// Object \"Enable Bucket Logging via CLI\" functions:\nfunction checkremediationviacli() //Check if the enable logging should be done via the CLI?\n{\n    if (configuration.enablebucketloggingviacli == \"true\") {\n        if (indexRemediate < bucketArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\n\n\nfunction printBucketName() { // Function to print the S3 buckets that will be remediated.\n    let bucket = bucketArr[indexRemediate]\n    let arr = bucket.split(\":::\")\n    return `echo Compliance Violation ${configuration.rec_id} for the S3 bucket ${arr[arr.length-1]}`;\n}\n\n\n// Object \"Create Logging JSON\" functions:\n\nfunction getfilepath() { //Getting the filepath and name for the file that will be created.\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    return `${configuration.inputfolder}${arr[arr.length-1]}-${configuration.rec_id}.json`;\n}\n\nfunction getfilecontent() { //Getting the file content of what will be written into the file itself.\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    const myjson = JSON.stringify(configuration.loggingconfiguration);\n    return `${myjson}`;\n}\n\n// Object \"Apply logging configuration\" functions:\nfunction enablebucketlogging() { // Replace the Bucket Policy via CLI\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    let myoutput = JSON.stringify(configuration.bucketpolicy);\n    return `aws s3api put-bucket-logging --bucket ${arr[arr.length-1]} --bucket-logging-status file://${configuration.inputfolder}${arr[arr.length-1]}-${configuration.rec_id}.json`; //Using the setting --acl private. Feel free to replace it with whatever you think is the right aws cli command to trigger.\n}\n\n// Object \"Send Statistics\"\nfunction checkslackstatistics(){\n    if (configuration.sendslackstatistics == \"true\") {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction sendstatistics() { // Function to send out a slack message for statistic informations.\n        return `Statistics for Map Compliance Map ${configuration.rec_id}: In total found ${resourcesArrLength} S3 buckets that are violating this compliance rule. ${bucketArrLength} of them will be remediated. ${bucketIgnoredArrLength} will be ignored as they are configured from the total of ${bucketConfiguredIgnoredArrLength} to be ignored S3 buckets.`;\n}\n\n// Object \"Remediated\" functions:\nfunction checkforslack() { //Check if you want to also see the resources via the slack messages.\n    if (indexSlack < bucketArr.length && configuration.sendslackmessagesforremediation == \"true\") {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction sendslackmessage() { // Function to send out a slack message for every S3 bucket that will be remediated.\n    let bucket = bucketArr[indexSlack];\n    let arr = bucket.split(\":::\");\n    if (configuration.dotheremediationviacli == \"true\") {\n        return `Compliance Violation ${configuration.rec_id} The following S3 bucket is auto remediated back to ${configuration.violationdescription}: ${arr[arr.length - 1]}. Using AWS CLI command to do the remediation of the bucket. More information about the event is available at ${link}`;\n    }\n    else if (configuration.dotheremediationviaobject == \"true\") {\n        return `Compliance Violation ${configuration.rec_id} The following S3 bucket is auto remediated back to ${configuration.violationdescription}: ${arr[arr.length - 1]}. Using the Kaholo S3 object to do the remediation of the bucket. More information about the event is available at ${link}`;\n    }\n    else {\n        return `Compliance Violation ${configuration.rec_id}. Auto Remediation is diabled! The following S3 bucket would be auto remediated back to ${configuration.violationdescription}: ${arr[arr.length - 1]}. Would execute CLI command aws s3api put-bucket-logging --bucket ${arr[arr.length-1]}. More information about the event is available at ${link}`;\n    }\n}\n\n// Object \"Ignored\" functions:\nfunction checkforignoredslack() { //Check if you want to also see the ignored buckets via the slack messages.\n    if (indexIgnored < bucketIgnoredArr.length && configuration.sendslackmessagesforignored == \"true\") {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction sendslackmessageforignored() { // Function to send out a slack message for every S3 bucket that will be ignored but is violating the policy.\n    let bucket = bucketIgnoredArr[indexIgnored];\n    let arr = bucket.split(\":::\");\n    return `Compliance Violation ${configuration.rec_id} The following S3 bucket is NOT remediated back to ${configuration.violationdescription}: ${arr[arr.length - 1]}. It is ignored by the configuration of the Map. We recommend using tags in AWS to suppress this S3 bucket from triggering alerts in Lacework. More information about the event is available at ${link}`;\n}\n\n// Object \"Get current suppression configuration\" functions:\nfunction checksuppressionconfiguration() {\n    if (configuration.configuresuppressiononpolicy == \"true\") {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction getrecommendationID() {\n    return `${configuration.rec_id}`;\n}\n\nfunction createcurrentsuppressionsetting() { //Function to put the current settings of a suppression configuration.\n    let q = configuration.suppressionuuid;\n    let laceworkAPIResult = getAction(q);\n    let suppressionConditions = `laceworkAPIResult.result.result.data[0].${configuration.rec_id}.suppressionConditions`;\n   // let suppressionConditions = laceworkAPIResult.result.result.data[0].LW_S3_1.suppressionConditions;\n    suppressionTag = \"NotConfigured\";\n    for (let i = 0; i < suppressionConditions.length; i++) {\n        let suppressionResourceTags = laceworkAPIResult.result.result.data[0].LW_S3_13.suppressionConditions[i].resourceTags;\n        for (let j = 0; j < suppressionResourceTags.length; j++) {\n            if (suppressionResourceTags[j].key == configuration.tagname)\n            {\n                suppressionTag = \"Configured\";\n                suppressionValue = suppressionResourceTags[j].value;\n            }\n        }\n    }\n}\n\n// Object \"Configure Suppression via Tags\" functions:\nfunction checksuppressionneedstobeconfigured() {\n    if (suppressionTag == \"Configured\") {\n        if (suppressionValue == configuration.tagvalue)\n        {\n            // Nothing to configure, tagkey and tagvalue are configured correctly.\n            return 0;\n        }\n        else \n        {\n            // Suppression Tag is correct, however the value is configured wrong.\n            return 1;\n        }\n    }\n    else {\n        // Suppression Tag is not configured.\n        return 1;\n    }\n}\n\nfunction getrecommendationIDforSuppression() {\n    return `${configuration.rec_id}`;\n}\n\nfunction getTagKeyforSuppression() {\n    return `${configuration.tagname}`;\n}\n\nfunction getTagValueforSuppression() {\n    return `${configuration.tagvalue}`;\n}\n\nfunction getsuppressionpolicycommentforSuppression() {\n    return `${configuration.suppressionpolicycomment}`;\n}\n\n// Help Functions for all Objects.\nfunction getAction(pId) {  // Help function to get the return value of the event.\n    let p = getProcessById(pId)//Get the process. \n    if (!p || !p.length) return;\n    p = p[p.length - 1].actions; //Get all actions \n    let action = p[Object.keys(p)[0]];//get the needed action \n    return action\n}\n\nfunction getvault() {\n    return `echo ${vault.test}`;\n}\n\nasync function useKey(key){\n  return vault.getValueByKey(key)\n}\n\n// No longer used\n\nfunction checkconditionforobject()\n{\n    if (configuration.enablebucketloggingviaobject == \"true\") {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction getbucketnameforremediation() {\n    let bucket = bucketArr[indexRemediate2]\n    let arr = bucket.split(\":::\")\n    return `${arr[arr.length-1]}`;\n}\n\nfunction createnewpolicyjson() { // Optional (Not in use): A way how you can create the JSON file on the command line.\n    let bucket = bucketArr[indexRemediate2];\n    let arr = bucket.split(\":::\");\n    configuration.bucketpolicy.Statement[0].Resource = bucket;\n    const myjson = JSON.stringify(configuration.bucketpolicy)\n    //let myoutput = myjson.replace(/\"/g, '\\\"');\n    return `${myjson}`;\n}\n\nfunction testprint () { // Test Print, not in use so far.\n   configuration.bucketpolicy.Statement[0].Resource = \"adflkasdflkjasdf\"\n   let myoutput = JSON.stringify(configuration.bucketpolicy);\n   return `echo ${myoutput}`;\n}\n\nfunction remediateviaobject() { // Remediate the S3 buckets back to private acl.\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    return `${arr[arr.length-1]}`; //Using the canned acl private.\n}\n"
}