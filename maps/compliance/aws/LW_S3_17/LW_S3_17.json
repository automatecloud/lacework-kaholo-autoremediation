{
    "configurations": [
        {
            "_id": "613898549cf410003982988a",
            "name": "LaceworkConfig",
            "value": "{\n    \"name\": \"LaceworkConfiguration\",\n    \"rec_id\": \"LW_S3_17\",\n    \"violationdescription\": \"Ensure the S3 bucket access is restricted to a whitelist of IP networks.\",\n    \"eventuuid\": \"edb32ef5-243a-4b7f-bac8-e764823911e2\",\n    \"reportuuid\": \"13d4847c-37be-493d-a8b5-9c91081bbd02\",\n    \"dothedeletebucketpolicyremediationviacli\": \"false\",\n    \"dothedeletebucketpolicyremediationviaobject\": \"false\",\n    \"dothereplacebucketpolicyremediationviacli\": \"false\",\n    \"dothereplacebucketpolicyremediationviaobject\": \"false\",\n    \"sendslackmessagesforremediation\": \"false\",\n    \"sendslackmessagesforignored\": \"false\",\n    \"bucketIgnoreList\":[\n        \"arn:aws:s3:::mybucket01\",\n        \"arn:aws:s3:::mybucket02\",\n        \"arn:aws:s3:::mybucket03\"\n    ],\n    \"awsaccountid\": \"123456789012\",\n    \"reporttype\": \"AWS_CIS_S3\",\n    \"putbuckettaggingviacli\": \"false\",\n    \"putbuckettaggingviaobject\": \"false\",\n    \"tagname\": \"LW_S3_17\",\n    \"tagvalue\": \"suppressed\",\n    \"configuresuppressiononpolicy\": \"false\",\n    \"suppressionpolicycomment\": \"Auto Configured via Kaholo\",\n    \"autoremediationonlyfornewviolations\": \"false\",\n    \"suppressionuuid\": \"bb7e8bad-455d-4b23-9371-0ad9284fe2ea\",\n    \"createbackup\": \"true\",\n    \"inputfolder\": \"/usr/src/app/scripts/input/\",\n    \"backupfolder\": \"/usr/src/app/scripts/output/\",\n    \"bucketpolicy\": {\n        \"Version\": \"2012-10-17\",\n        \"Id\": \"VPCe and SourceIP\",\n        \"Statement\": [\n            {\n                \"Sid\": \"VPCe and SourceIP\",\n                \"Effect\": \"Deny\",\n                \"Principal\": \"*\",\n                \"Action\": \"s3:*\",\n                \"Resource\": [\n                    \"arn:aws:s3:::YOURBUCKET\",\n                    \"arn:aws:s3:::YOURBUCKET/*\"\n                ],\n                \"Condition\": {\n                    \"StringNotLike\": {\n                        \"aws:sourceVpce\": [\n                            \"vpce-YOURVPC1\",\n                            \"vpce-YOURVPC2\"\n                        ]\n                    },\n                    \"NotIpAddress\": {\n                        \"aws:SourceIp\": [\n                            \"11.11.11.11/32\",\n                            \"22.22.22.22/32\"\n                        ]\n                    }\n                }\n            }\n        ]\n    }\n}\n",
            "mapRevision": "613898549cf4100039829814",
            "__v": 0
        }
    ],
    "processes": [
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "6053581a887b2000349b6558",
                            "code": true,
                            "value": "geteventid()",
                            "param": "6036a2e807d26400341da678",
                            "name": "EVENT_ID"
                        }
                    ],
                    "name": "geteventid",
                    "timeout": null,
                    "method": "GetEventDetails",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "lacework",
                "version": "1.0.0"
            },
            "uuid": "edb32ef5-243a-4b7f-bac8-e764823911e2",
            "numProcessParallel": null,
            "name": "Get event details",
            "description": null,
            "condition": "checkconfiguration()",
            "coordination": null,
            "filterAgents": null,
            "postRun": "createBucketList() ",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "name": "printBucketName",
                    "timeout": null,
                    "retries": 0,
                    "method": "execute",
                    "mandatory": null,
                    "params": [
                        {
                            "code": null,
                            "value": null,
                            "param": null,
                            "viewName": "Working Directory",
                            "name": "workingDir",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "printBucketName()",
                            "param": null,
                            "viewName": "command",
                            "name": "COMMANDS",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": null,
                            "value": null,
                            "param": null,
                            "viewName": "Wait for close",
                            "name": "exitOnClose",
                            "type": "boolean",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "CommandLine",
                "version": "1.2.0"
            },
            "uuid": "6bc1844a-4f56-46f4-b742-f9000115cf90",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Print Bucket Policy via CLI",
            "description": "S3 buckets to remediate\n",
            "condition": "checkdeleteremediationviacli()",
            "filterAgents": null,
            "postRun": "",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "613898549cf4100039829821",
                            "code": null,
                            "value": "Slack Webhook",
                            "param": "60958a59d0f6e00034dd382e",
                            "name": "webhookUrl"
                        },
                        {
                            "_id": "613898549cf4100039829822",
                            "code": true,
                            "value": "sendslackmessage()",
                            "param": "60958a59d0f6e00034dd382f",
                            "name": "message"
                        }
                    ],
                    "name": "informsecurity",
                    "timeout": null,
                    "method": "sendIncomingWebhook",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Slack",
                "version": "1.1.0"
            },
            "uuid": "9f29c8df-ccbe-442f-a1e6-6e8b996d8916",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Remediated",
            "description": null,
            "condition": "checkforslack()",
            "filterAgents": null,
            "postRun": "indexSlack++;",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "name": "printBucketName",
                    "timeout": null,
                    "retries": 0,
                    "method": "execute",
                    "mandatory": null,
                    "params": [
                        {
                            "code": null,
                            "value": null,
                            "param": null,
                            "viewName": "Working Directory",
                            "name": "workingDir",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "printBucketName()",
                            "param": null,
                            "viewName": "command",
                            "name": "COMMANDS",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": null,
                            "value": null,
                            "param": null,
                            "viewName": "Wait for close",
                            "name": "exitOnClose",
                            "type": "boolean",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "CommandLine",
                "version": "1.2.0"
            },
            "uuid": "c93f881a-3dcd-4c80-893a-91d63f16751f",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Print Bucket name via CLI",
            "description": "S3 buckets to remediate\n",
            "condition": "checkreplaceremediationviacli()",
            "filterAgents": null,
            "postRun": "",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "name": "remediateviacli",
                    "timeout": null,
                    "retries": 0,
                    "method": "execute",
                    "mandatory": null,
                    "params": [
                        {
                            "code": null,
                            "value": null,
                            "param": null,
                            "viewName": "Working Directory",
                            "name": "workingDir",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "replacebucketpolicyviacli()",
                            "param": null,
                            "viewName": "command",
                            "name": "COMMANDS",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": null,
                            "value": null,
                            "param": null,
                            "viewName": "Wait for close",
                            "name": "exitOnClose",
                            "type": "boolean",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "CommandLine",
                "version": "1.2.0"
            },
            "uuid": "71f2758e-a441-4a63-a6ce-a6d3ae94767e",
            "numProcessParallel": null,
            "name": "Replace Bucket Policy via CLI",
            "description": null,
            "condition": "",
            "filterAgents": null,
            "postRun": "indexRemediate++;",
            "preRun": null,
            "coordination": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "name": "listbucketpolicy",
                    "timeout": null,
                    "retries": 0,
                    "method": "getBucketPolicy",
                    "mandatory": null,
                    "params": [
                        {
                            "code": true,
                            "value": "getawsaccesskeyfromvaultforremediation()",
                            "param": "60958a59d0f6e00034dd383a",
                            "viewName": "Access key",
                            "name": "AWS_ACCESS_KEY_ID",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getawssecretkeyfromvaultforremediation()",
                            "param": "60958a59d0f6e00034dd383b",
                            "viewName": "Secret key",
                            "name": "AWS_SECRET_ACCESS_KEY",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getbucketname()",
                            "param": "60958a59d0f6e00034dd383c",
                            "viewName": "Bucket name",
                            "name": "bucketName",
                            "type": "string",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Amazon-aws-s3",
                "version": "1.4.0"
            },
            "uuid": "23fd6698-db5a-4931-bc91-8cbb47609219",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Backup Bucket Policy via Object",
            "description": null,
            "condition": "checkdeleteremediationviaobject()",
            "filterAgents": null,
            "postRun": "",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "name": "getbucketpolicy",
                    "timeout": null,
                    "retries": 0,
                    "method": "getBucketPolicy",
                    "mandatory": null,
                    "params": [
                        {
                            "code": true,
                            "value": "getawsaccesskeyfromvaultforremediation()",
                            "param": "60958a59d0f6e00034dd383f",
                            "viewName": "Access key",
                            "name": "AWS_ACCESS_KEY_ID",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getawssecretkeyfromvaultforremediation()",
                            "param": "60958a59d0f6e00034dd3840",
                            "viewName": "Secret key",
                            "name": "AWS_SECRET_ACCESS_KEY",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getbucketname()",
                            "param": "60958a59d0f6e00034dd3841",
                            "viewName": "Bucket name",
                            "name": "bucketName",
                            "type": "string",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Amazon-aws-s3",
                "version": "1.4.0"
            },
            "uuid": "80b2519f-1ef4-47e6-8557-374c4b8ad0a6",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Backup Bucket Policy via Object",
            "description": "S3 buckets to remediate\n",
            "condition": "checkreplaceremediationviaobject()",
            "filterAgents": null,
            "postRun": "",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "60958a59d0f6e00034dd3844",
                            "code": null,
                            "value": "Slack Webhook",
                            "param": null,
                            "name": "webhookUrl"
                        },
                        {
                            "_id": "60958a59d0f6e00034dd3845",
                            "code": true,
                            "value": "sendslackmessageforignored()",
                            "param": null,
                            "name": "message"
                        }
                    ],
                    "name": "sendslackmessageforignored",
                    "timeout": null,
                    "method": "sendIncomingWebhook",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Slack",
                "version": "1.1.0"
            },
            "uuid": "139dcaf6-9584-47f2-8219-d71c1da608db",
            "numProcessParallel": null,
            "name": "Ignored",
            "description": null,
            "condition": "checkforignoredslack()",
            "filterAgents": null,
            "postRun": "indexIgnored++;",
            "preRun": null,
            "coordination": "each"
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "name": "createfile",
                    "timeout": null,
                    "retries": 0,
                    "method": "createFile",
                    "mandatory": null,
                    "params": [
                        {
                            "code": true,
                            "value": "getfilepath()",
                            "param": "60958a59d0f6e00034dd3848",
                            "viewName": "File path",
                            "name": "PATH",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getfilecontent()",
                            "param": "60958a59d0f6e00034dd3849",
                            "viewName": "File Content",
                            "name": "CONTENT",
                            "type": "text",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "TextEditor",
                "version": "1.0.0"
            },
            "uuid": "fb18b790-e884-4308-b05f-e7d332128ca3",
            "numProcessParallel": null,
            "name": "Create the new JSON file",
            "description": null,
            "condition": "",
            "filterAgents": null,
            "postRun": "",
            "preRun": null,
            "coordination": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "name": "deletebucketpolicy",
                    "timeout": null,
                    "retries": 0,
                    "method": "deleteBucketPolicy",
                    "mandatory": null,
                    "params": [
                        {
                            "code": true,
                            "value": "getawsaccesskeyfromvaultforremediation()",
                            "param": null,
                            "viewName": "Access key",
                            "name": "AWS_ACCESS_KEY_ID",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getawssecretkeyfromvaultforremediation()",
                            "param": null,
                            "viewName": "Secret key",
                            "name": "AWS_SECRET_ACCESS_KEY",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getbucketnameforremediation()",
                            "param": null,
                            "viewName": "Bucket name",
                            "name": "bucketName",
                            "type": "string",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Amazon-aws-s3",
                "version": "1.5.4"
            },
            "uuid": "ffb8cb43-2359-47b1-bf74-8ed195292804",
            "numProcessParallel": null,
            "name": "Delete Bucket Policy via Object",
            "description": null,
            "condition": "",
            "filterAgents": null,
            "postRun": "indexRemediate++;",
            "preRun": null,
            "coordination": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "name": "createfile",
                    "timeout": null,
                    "retries": 0,
                    "method": "createFile",
                    "mandatory": null,
                    "params": [
                        {
                            "code": true,
                            "value": "getfilepath()",
                            "param": "60958a59d0f6e00034dd3851",
                            "viewName": "File path",
                            "name": "PATH",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getfilecontent()",
                            "param": "60958a59d0f6e00034dd3852",
                            "viewName": "File Content",
                            "name": "CONTENT",
                            "type": "text",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "TextEditor",
                "version": "1.0.0"
            },
            "uuid": "0ec3f7ec-9ad2-41a1-8b40-752950395db4",
            "numProcessParallel": null,
            "name": "Create the new JSON file",
            "description": null,
            "condition": "",
            "filterAgents": null,
            "postRun": "",
            "preRun": null,
            "coordination": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": false,
            "mandatory": false,
            "actions": [
                {
                    "name": "replacebucketpolicy",
                    "timeout": null,
                    "retries": 0,
                    "method": "putBucketPolicy",
                    "mandatory": null,
                    "params": [
                        {
                            "code": true,
                            "value": "getawsaccesskeyfromvaultforremediation()",
                            "param": null,
                            "viewName": "Access key",
                            "name": "AWS_ACCESS_KEY_ID",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getawssecretkeyfromvaultforremediation()",
                            "param": null,
                            "viewName": "Secret key",
                            "name": "AWS_SECRET_ACCESS_KEY",
                            "type": "vault",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "getbucketnameforremediation()",
                            "param": null,
                            "viewName": "Bucket name",
                            "name": "bucketName",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "createnewpolicyjson()",
                            "param": null,
                            "viewName": "Policy JSON String",
                            "name": "policy",
                            "type": "string",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "Amazon-aws-s3",
                "version": "1.5.4"
            },
            "uuid": "490ce396-3ec7-4dea-8d7f-88ff7590eb68",
            "numProcessParallel": null,
            "name": "Replace Bucket Policy via Object",
            "description": null,
            "condition": "",
            "filterAgents": null,
            "postRun": "indexRemediate++;",
            "preRun": null,
            "coordination": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "60958a59d0f6e00034dd385b",
                            "code": true,
                            "value": "getawsaccountid()",
                            "param": null,
                            "name": "AWS_ACCOUNT_ID"
                        },
                        {
                            "_id": "60958a59d0f6e00034dd385c",
                            "code": true,
                            "value": "getreporttype()",
                            "param": null,
                            "name": "REPORT_TYPE"
                        }
                    ],
                    "name": "getreportdetails",
                    "timeout": null,
                    "method": "GetLatestAWSComplianceReportDetails",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "lacework",
                "version": "1.2.0"
            },
            "uuid": "13d4847c-37be-493d-a8b5-9c91081bbd02",
            "numProcessParallel": null,
            "name": "Get report details",
            "description": null,
            "condition": "checkconfigurationforreport()",
            "coordination": null,
            "filterAgents": null,
            "postRun": "createBucketListfromReport()",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "60958a59d0f6e00034dd385f",
                            "code": true,
                            "value": "putbuckettagging()",
                            "param": null,
                            "name": "COMMANDS"
                        }
                    ],
                    "name": "putbuckettagging",
                    "timeout": null,
                    "method": "execute",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "CommandLine",
                "version": "1.2.0"
            },
            "uuid": "61b3c90d-a3fe-4e48-8286-e926b8e75011",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "Put Bucket Tags via CLI",
            "description": null,
            "condition": "checkputbuckettagsviacli()",
            "filterAgents": null,
            "postRun": "indexTag++;",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "60958a59d0f6e00034dd3862",
                            "code": true,
                            "value": "getawsaccesskeyfromvaultfortag()",
                            "param": null,
                            "name": "accessKeyId"
                        },
                        {
                            "_id": "60958a59d0f6e00034dd3863",
                            "code": true,
                            "value": "getawssecretkeyfromvaultfortag()",
                            "param": null,
                            "name": "secretAccesKey"
                        },
                        {
                            "_id": "60958a59d0f6e00034dd3864",
                            "code": null,
                            "value": {
                                "id": "eu-central-1",
                                "value": "EU (Frankfurt)"
                            },
                            "param": null,
                            "name": "region"
                        },
                        {
                            "_id": "60958a59d0f6e00034dd3865",
                            "code": true,
                            "value": "getbucketnameforobject()",
                            "param": null,
                            "name": "resourcesArn"
                        },
                        {
                            "_id": "60958a59d0f6e00034dd3866",
                            "code": true,
                            "value": "getbuckettagsforobject()",
                            "param": null,
                            "name": "tags"
                        }
                    ],
                    "name": "puttag",
                    "timeout": null,
                    "method": "tagResources",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "AWS-resource-groups-tagging",
                "version": "1.1.0"
            },
            "uuid": "ad5fa8ff-e5d6-43ed-b7b0-142e9c6750be",
            "coordination": "each",
            "numProcessParallel": null,
            "name": "PutBucket Tags via Object",
            "description": null,
            "condition": "checkputbuckettagsviaobject()",
            "filterAgents": null,
            "postRun": "indexTag++;",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": null,
            "mandatory": null,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "61267ddfacb7e500f6845db8",
                            "code": true,
                            "value": "getrecommendationID()",
                            "param": null,
                            "name": "REC_ID"
                        }
                    ],
                    "name": "getcurrentsuppressionconfiguration",
                    "timeout": null,
                    "method": "GetAWSSuppressionforarecommendationID",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "lacework",
                "version": "1.2.3"
            },
            "uuid": "bb7e8bad-455d-4b23-9371-0ad9284fe2ea",
            "coordination": "race",
            "numProcessParallel": null,
            "name": "Get current suppression configuration",
            "description": "Check the current suppression configuration.",
            "condition": "checksuppressionconfiguration()",
            "filterAgents": null,
            "postRun": "createcurrentsuppressionsetting()",
            "preRun": null
        },
        {
            "flowControl": "each",
            "actionsExecution": "series",
            "correlateAgents": false,
            "mandatory": false,
            "actions": [
                {
                    "retries": 0,
                    "mandatory": null,
                    "isEnabled": true,
                    "params": [
                        {
                            "_id": "61267ddfacb7e500f6845dbb",
                            "code": true,
                            "value": "getrecommendationIDforSuppression()",
                            "param": null,
                            "name": "REC_ID"
                        },
                        {
                            "_id": "61267ddfacb7e500f6845dbc",
                            "code": true,
                            "value": "getTagKeyforSuppression()",
                            "param": null,
                            "name": "TAG_KEY"
                        },
                        {
                            "_id": "61267ddfacb7e500f6845dbd",
                            "code": true,
                            "value": "getTagValueforSuppression()",
                            "param": null,
                            "name": "TAG_VALUE"
                        },
                        {
                            "_id": "61267ddfacb7e500f6845dbe",
                            "code": true,
                            "value": "getsuppressionpolicycommentforSuppression()",
                            "param": null,
                            "name": "SUPPRESSION_COMMENT"
                        }
                    ],
                    "name": "Set Suppression Configuration",
                    "timeout": null,
                    "method": "ConfigureSuppressionviaTagforAWS",
                    "numParallel": null
                }
            ],
            "used_plugin": {
                "name": "lacework",
                "version": "1.2.3"
            },
            "uuid": "35605515-c1b7-4a85-a12c-7de0e4a7a283",
            "numProcessParallel": null,
            "name": "Configure Suppression via Tags",
            "description": null,
            "condition": "checksuppressionneedstobeconfigured()",
            "coordination": null,
            "filterAgents": null,
            "postRun": null,
            "preRun": null
        },
        {
            "used_plugin": {
                "name": "CommandLine",
                "version": "2.0.1"
            },
            "uuid": "7820e1ca-feef-4bcf-86ed-22e5e1d43ded",
            "numProcessParallel": null,
            "name": "Create Backup via CLI",
            "description": "Create a Backup of the Bucket Policy via CLI",
            "mandatory": null,
            "condition": null,
            "coordination": null,
            "actions": [
                {
                    "name": "createbackup",
                    "timeout": null,
                    "retries": 0,
                    "method": "execute",
                    "mandatory": null,
                    "params": [
                        {
                            "code": null,
                            "value": null,
                            "param": null,
                            "viewName": "Working Directory",
                            "name": "workingDir",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "createbackup()",
                            "param": null,
                            "viewName": "command",
                            "name": "COMMANDS",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": null,
                            "value": null,
                            "param": null,
                            "viewName": "Wait for close",
                            "name": "exitOnClose",
                            "type": "boolean",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "correlateAgents": null,
            "filterAgents": null,
            "postRun": null,
            "preRun": null,
            "actionsExecution": "series"
        },
        {
            "used_plugin": {
                "name": "CommandLine",
                "version": "2.0.1"
            },
            "uuid": "346e3cec-5ff5-4015-a2a0-804160e9c616",
            "numProcessParallel": null,
            "name": "Delete Bucket Policy via CLI",
            "description": "Delete the Bucket Policy via CLI",
            "mandatory": null,
            "condition": null,
            "coordination": null,
            "actions": [
                {
                    "name": "deleteviaawscli",
                    "timeout": null,
                    "retries": 0,
                    "method": "execute",
                    "mandatory": null,
                    "params": [
                        {
                            "code": null,
                            "value": null,
                            "param": null,
                            "viewName": "Working Directory",
                            "name": "workingDir",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "deleteviaawscli()",
                            "param": null,
                            "viewName": "command",
                            "name": "COMMANDS",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": null,
                            "value": null,
                            "param": null,
                            "viewName": "Wait for close",
                            "name": "exitOnClose",
                            "type": "boolean",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "correlateAgents": null,
            "filterAgents": null,
            "postRun": "indexRemediate++;",
            "preRun": null,
            "actionsExecution": "series"
        },
        {
            "used_plugin": {
                "name": "CommandLine",
                "version": "2.0.1"
            },
            "uuid": "50a74597-948a-4c52-a037-6fbc176ac4b1",
            "numProcessParallel": null,
            "name": "Create Backup via CLI",
            "description": "Create a backup of the bucket policy via CLI",
            "mandatory": null,
            "condition": null,
            "coordination": null,
            "actions": [
                {
                    "name": "createbackup",
                    "timeout": null,
                    "retries": 0,
                    "method": "execute",
                    "mandatory": null,
                    "params": [
                        {
                            "code": null,
                            "value": null,
                            "param": null,
                            "viewName": "Working Directory",
                            "name": "workingDir",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": true,
                            "value": "createbackup()",
                            "param": null,
                            "viewName": "command",
                            "name": "COMMANDS",
                            "type": "string",
                            "description": null
                        },
                        {
                            "code": null,
                            "value": null,
                            "param": null,
                            "viewName": "Wait for close",
                            "name": "exitOnClose",
                            "type": "boolean",
                            "description": null
                        }
                    ],
                    "isEnabled": true,
                    "numParallel": null
                }
            ],
            "correlateAgents": null,
            "filterAgents": null,
            "postRun": null,
            "preRun": null,
            "actionsExecution": "series"
        }
    ],
    "links": [
        {
            "uuid": "62ba9343-79dc-4a5d-ac0a-6d47123b41f2",
            "sourceId": "6297d603-cd5f-4fca-b5f5-4d14847dcd94",
            "targetId": "edb32ef5-243a-4b7f-bac8-e764823911e2"
        },
        {
            "uuid": "5e0ad33c-7098-40fe-8df8-6e014a66fc72",
            "sourceId": "edb32ef5-243a-4b7f-bac8-e764823911e2",
            "targetId": "6bc1844a-4f56-46f4-b742-f9000115cf90"
        },
        {
            "uuid": "7ae6317d-2410-4e66-b938-988966239800",
            "sourceId": "edb32ef5-243a-4b7f-bac8-e764823911e2",
            "targetId": "9f29c8df-ccbe-442f-a1e6-6e8b996d8916"
        },
        {
            "uuid": "7d7011f4-f28f-48f5-9b9e-b5139a312cbd",
            "sourceId": "9f29c8df-ccbe-442f-a1e6-6e8b996d8916",
            "targetId": "9f29c8df-ccbe-442f-a1e6-6e8b996d8916"
        },
        {
            "uuid": "c738db2b-bfe0-4221-b3d2-3c37cf0385c2",
            "sourceId": "edb32ef5-243a-4b7f-bac8-e764823911e2",
            "targetId": "c93f881a-3dcd-4c80-893a-91d63f16751f"
        },
        {
            "uuid": "fdf27188-3df3-407b-9e23-bc27bef6ad1f",
            "sourceId": "fb18b790-e884-4308-b05f-e7d332128ca3",
            "targetId": "71f2758e-a441-4a63-a6ce-a6d3ae94767e"
        },
        {
            "uuid": "60aa4462-dbe1-47af-af89-b3185c0bcb3e",
            "sourceId": "edb32ef5-243a-4b7f-bac8-e764823911e2",
            "targetId": "23fd6698-db5a-4931-bc91-8cbb47609219"
        },
        {
            "uuid": "0d8f2290-1aac-4a97-86cf-fbefd7e55247",
            "sourceId": "edb32ef5-243a-4b7f-bac8-e764823911e2",
            "targetId": "80b2519f-1ef4-47e6-8557-374c4b8ad0a6"
        },
        {
            "uuid": "a973fefa-1d2a-4c5f-9d77-b1178784c8f3",
            "sourceId": "139dcaf6-9584-47f2-8219-d71c1da608db",
            "targetId": "139dcaf6-9584-47f2-8219-d71c1da608db"
        },
        {
            "uuid": "c87c96af-d3d8-452a-875e-6a6dc6acc056",
            "sourceId": "23fd6698-db5a-4931-bc91-8cbb47609219",
            "targetId": "ffb8cb43-2359-47b1-bf74-8ed195292804"
        },
        {
            "uuid": "34334cd8-e453-4167-a198-a437615e342a",
            "sourceId": "80b2519f-1ef4-47e6-8557-374c4b8ad0a6",
            "targetId": "0ec3f7ec-9ad2-41a1-8b40-752950395db4"
        },
        {
            "uuid": "ddad6703-44fd-43cb-977b-16e75cd5ac60",
            "sourceId": "0ec3f7ec-9ad2-41a1-8b40-752950395db4",
            "targetId": "490ce396-3ec7-4dea-8d7f-88ff7590eb68"
        },
        {
            "uuid": "c47653c5-405e-4e01-becc-d6f29fd494c0",
            "sourceId": "6297d603-cd5f-4fca-b5f5-4d14847dcd94",
            "targetId": "13d4847c-37be-493d-a8b5-9c91081bbd02"
        },
        {
            "uuid": "069052be-5a27-45ec-ba32-a77a75b68bb2",
            "sourceId": "13d4847c-37be-493d-a8b5-9c91081bbd02",
            "targetId": "6bc1844a-4f56-46f4-b742-f9000115cf90"
        },
        {
            "uuid": "3d86cf60-62ee-4d80-a088-45c3367996a4",
            "sourceId": "13d4847c-37be-493d-a8b5-9c91081bbd02",
            "targetId": "c93f881a-3dcd-4c80-893a-91d63f16751f"
        },
        {
            "uuid": "9bcbc1e8-9fdb-44a5-9194-9198846dce42",
            "sourceId": "13d4847c-37be-493d-a8b5-9c91081bbd02",
            "targetId": "9f29c8df-ccbe-442f-a1e6-6e8b996d8916"
        },
        {
            "uuid": "29a19a44-7132-4aa5-992c-39c762140d97",
            "sourceId": "edb32ef5-243a-4b7f-bac8-e764823911e2",
            "targetId": "139dcaf6-9584-47f2-8219-d71c1da608db"
        },
        {
            "uuid": "548eac42-2161-413c-a1b8-d44629120fec",
            "sourceId": "13d4847c-37be-493d-a8b5-9c91081bbd02",
            "targetId": "139dcaf6-9584-47f2-8219-d71c1da608db"
        },
        {
            "uuid": "8ce80210-7d81-4e6b-ae1b-0217b87746d8",
            "sourceId": "13d4847c-37be-493d-a8b5-9c91081bbd02",
            "targetId": "23fd6698-db5a-4931-bc91-8cbb47609219"
        },
        {
            "uuid": "0be15b5b-de5a-44aa-96a4-a5873bb12bed",
            "sourceId": "13d4847c-37be-493d-a8b5-9c91081bbd02",
            "targetId": "80b2519f-1ef4-47e6-8557-374c4b8ad0a6"
        },
        {
            "uuid": "442c7856-07a3-427a-9c82-05447f16b5a9",
            "sourceId": "61b3c90d-a3fe-4e48-8286-e926b8e75011",
            "targetId": "61b3c90d-a3fe-4e48-8286-e926b8e75011"
        },
        {
            "uuid": "18c2a902-ce58-4444-a82f-8fbe5326e05e",
            "sourceId": "ad5fa8ff-e5d6-43ed-b7b0-142e9c6750be",
            "targetId": "ad5fa8ff-e5d6-43ed-b7b0-142e9c6750be"
        },
        {
            "uuid": "6e07f0d1-8d09-48e0-9bcf-dff389c017a0",
            "sourceId": "edb32ef5-243a-4b7f-bac8-e764823911e2",
            "targetId": "61b3c90d-a3fe-4e48-8286-e926b8e75011"
        },
        {
            "uuid": "653f7875-da7a-4983-9663-a257bb165e1a",
            "sourceId": "13d4847c-37be-493d-a8b5-9c91081bbd02",
            "targetId": "61b3c90d-a3fe-4e48-8286-e926b8e75011"
        },
        {
            "uuid": "b866047d-1b12-4428-8f30-f1ec1cbabb62",
            "sourceId": "edb32ef5-243a-4b7f-bac8-e764823911e2",
            "targetId": "ad5fa8ff-e5d6-43ed-b7b0-142e9c6750be"
        },
        {
            "uuid": "66dc8841-6ae2-4f92-8e73-4f06934cfb8a",
            "sourceId": "13d4847c-37be-493d-a8b5-9c91081bbd02",
            "targetId": "ad5fa8ff-e5d6-43ed-b7b0-142e9c6750be"
        },
        {
            "uuid": "7598026d-43df-4a0f-becd-fb1ebd630885",
            "sourceId": "edb32ef5-243a-4b7f-bac8-e764823911e2",
            "targetId": "bb7e8bad-455d-4b23-9371-0ad9284fe2ea"
        },
        {
            "uuid": "a880dd52-b890-49a3-9bf6-481bba51fc0c",
            "sourceId": "13d4847c-37be-493d-a8b5-9c91081bbd02",
            "targetId": "bb7e8bad-455d-4b23-9371-0ad9284fe2ea"
        },
        {
            "uuid": "77d1f473-f4d5-4575-b99b-1e3ce3d6fe1c",
            "sourceId": "bb7e8bad-455d-4b23-9371-0ad9284fe2ea",
            "targetId": "35605515-c1b7-4a85-a12c-7de0e4a7a283"
        },
        {
            "uuid": "09ba81cc-a2a9-4e95-859f-796c9ba6405f",
            "sourceId": "6bc1844a-4f56-46f4-b742-f9000115cf90",
            "targetId": "7820e1ca-feef-4bcf-86ed-22e5e1d43ded"
        },
        {
            "uuid": "36c41454-cd15-4268-a969-6968c8f1a9bd",
            "sourceId": "7820e1ca-feef-4bcf-86ed-22e5e1d43ded",
            "targetId": "346e3cec-5ff5-4015-a2a0-804160e9c616"
        },
        {
            "uuid": "3ee45887-774e-4f3b-9ca3-221419f89c9d",
            "sourceId": "346e3cec-5ff5-4015-a2a0-804160e9c616",
            "targetId": "6bc1844a-4f56-46f4-b742-f9000115cf90"
        },
        {
            "uuid": "3ab6dcf5-4345-47ae-8e95-4e3bb9d3f545",
            "sourceId": "71f2758e-a441-4a63-a6ce-a6d3ae94767e",
            "targetId": "c93f881a-3dcd-4c80-893a-91d63f16751f"
        },
        {
            "uuid": "544db2c8-d861-42c5-a038-f4f42472b1c2",
            "sourceId": "c93f881a-3dcd-4c80-893a-91d63f16751f",
            "targetId": "50a74597-948a-4c52-a037-6fbc176ac4b1"
        },
        {
            "uuid": "3d9dec53-2b8d-434a-9b8d-8ad0bff3e0dc",
            "sourceId": "50a74597-948a-4c52-a037-6fbc176ac4b1",
            "targetId": "fb18b790-e884-4308-b05f-e7d332128ca3"
        },
        {
            "uuid": "2cb5d5a3-bdde-404f-be12-94bd38f86c95",
            "sourceId": "ffb8cb43-2359-47b1-bf74-8ed195292804",
            "targetId": "23fd6698-db5a-4931-bc91-8cbb47609219"
        },
        {
            "uuid": "7c8e9a0e-0883-446f-9682-f5fdf25482c7",
            "sourceId": "490ce396-3ec7-4dea-8d7f-88ff7590eb68",
            "targetId": "80b2519f-1ef4-47e6-8557-374c4b8ad0a6"
        }
    ],
    "content": "{\"cells\":[{\"type\":\"devs.PMStartPoint\",\"size\":{\"width\":40,\"height\":39},\"outPorts\":[\" \"],\"inPorts\":[],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\" \"}}}]},\"position\":{\"x\":90,\"y\":146},\"angle\":0,\"id\":\"6297d603-cd5f-4fca-b5f5-4d14847dcd94\",\"z\":1,\"attrs\":{\"rect\":{\"fill\":\"#2d3236\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":185,\"y\":12},\"angle\":0,\"id\":\"edb32ef5-243a-4b7f-bac8-e764823911e2\",\"z\":2,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Get event details\"},\".p_id\":{\"text\":\"60ec2ebeacb7e500f63e9f36\"},\"image\":{\"xlink:href\":\"/plugins/lacework/lacework.png\",\"ref-y\":50},\"text\":{\"text\":\"Get event details\"}}},{\"type\":\"link\",\"source\":{\"id\":\"6297d603-cd5f-4fca-b5f5-4d14847dcd94\",\"port\":\" \"},\"target\":{\"id\":\"edb32ef5-243a-4b7f-bac8-e764823911e2\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"62ba9343-79dc-4a5d-ac0a-6d47123b41f2\",\"z\":3,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":340,\"y\":-180},\"angle\":0,\"id\":\"6bc1844a-4f56-46f4-b742-f9000115cf90\",\"z\":4,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Print Bucket Policy via CLI\"},\".p_id\":{\"text\":\"60ec31a0acb7e500f63ea119\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Print Bucket Policy via CLI\"}}},{\"type\":\"link\",\"source\":{\"id\":\"edb32ef5-243a-4b7f-bac8-e764823911e2\",\"port\":\"  \"},\"target\":{\"id\":\"6bc1844a-4f56-46f4-b742-f9000115cf90\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"5e0ad33c-7098-40fe-8df8-6e014a66fc72\",\"z\":5,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":830,\"y\":161},\"angle\":0,\"id\":\"9f29c8df-ccbe-442f-a1e6-6e8b996d8916\",\"z\":7,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Remediated\"},\".p_id\":{\"text\":\"60ec2f8facb7e500f63e9f9b\"},\"image\":{\"xlink:href\":\"/plugins/Slack/Slack_Icon.png\",\"ref-y\":50},\"text\":{\"text\":\"Remediated\"}}},{\"type\":\"link\",\"source\":{\"id\":\"edb32ef5-243a-4b7f-bac8-e764823911e2\",\"port\":\"  \"},\"target\":{\"id\":\"9f29c8df-ccbe-442f-a1e6-6e8b996d8916\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"7ae6317d-2410-4e66-b938-988966239800\",\"z\":8,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"9f29c8df-ccbe-442f-a1e6-6e8b996d8916\",\"port\":\"  \"},\"target\":{\"id\":\"9f29c8df-ccbe-442f-a1e6-6e8b996d8916\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"7d7011f4-f28f-48f5-9b9e-b5139a312cbd\",\"z\":9,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":397,\"y\":-55},\"angle\":0,\"id\":\"c93f881a-3dcd-4c80-893a-91d63f16751f\",\"z\":10,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Print Bucket name via CLI\"},\".p_id\":{\"text\":\"60ec31a0acb7e500f63ea119\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Print Bucket name via CLI\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":899,\"y\":-63},\"angle\":0,\"id\":\"71f2758e-a441-4a63-a6ce-a6d3ae94767e\",\"z\":11,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Replace Bucket Policy via CLI\"},\".p_id\":{\"text\":\"60ec31a0acb7e500f63ea119\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Replace Bucket Policy via CLI\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":423,\"y\":367},\"angle\":0,\"id\":\"23fd6698-db5a-4931-bc91-8cbb47609219\",\"z\":12,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Backup Bucket Policy via Object\"},\".p_id\":{\"text\":\"60ec30a5acb7e500f63ea02f\"},\"image\":{\"xlink:href\":\"/plugins/Amazon-aws-s3/logo.png\",\"ref-y\":50},\"text\":{\"text\":\"Backup Bucket Policy via Object\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":376,\"y\":522},\"angle\":0,\"id\":\"80b2519f-1ef4-47e6-8557-374c4b8ad0a6\",\"z\":13,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Backup Bucket Policy via Object\"},\".p_id\":{\"text\":\"60ec30a5acb7e500f63ea02f\"},\"image\":{\"xlink:href\":\"/plugins/Amazon-aws-s3/logo.png\",\"ref-y\":50},\"text\":{\"text\":\"Backup Bucket Policy via Object\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":1020,\"y\":159},\"angle\":0,\"id\":\"139dcaf6-9584-47f2-8219-d71c1da608db\",\"z\":14,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Ignored\"},\".p_id\":{\"text\":\"60ec2f8facb7e500f63e9f9b\"},\"image\":{\"xlink:href\":\"/plugins/Slack/Slack_Icon.png\",\"ref-y\":50},\"text\":{\"text\":\"Ignored\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":721,\"y\":-59},\"angle\":0,\"id\":\"fb18b790-e884-4308-b05f-e7d332128ca3\",\"z\":15,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Create the new JSON file\"},\".p_id\":{\"text\":\"60ec2fbeacb7e500f63e9fc2\"},\"image\":{\"xlink:href\":\"/plugins/TextEditor/TextEditor.png\",\"ref-y\":50},\"text\":{\"text\":\"Create the new JSON file\"}}},{\"type\":\"link\",\"source\":{\"id\":\"edb32ef5-243a-4b7f-bac8-e764823911e2\",\"port\":\"  \"},\"target\":{\"id\":\"c93f881a-3dcd-4c80-893a-91d63f16751f\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"c738db2b-bfe0-4221-b3d2-3c37cf0385c2\",\"z\":16,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"fb18b790-e884-4308-b05f-e7d332128ca3\",\"port\":\"  \"},\"target\":{\"id\":\"71f2758e-a441-4a63-a6ce-a6d3ae94767e\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"b1a61947-eac1-4a8c-963e-111247904b22\",\"z\":18,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"edb32ef5-243a-4b7f-bac8-e764823911e2\",\"port\":\"  \"},\"target\":{\"id\":\"23fd6698-db5a-4931-bc91-8cbb47609219\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"60aa4462-dbe1-47af-af89-b3185c0bcb3e\",\"z\":19,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"edb32ef5-243a-4b7f-bac8-e764823911e2\",\"port\":\"  \"},\"target\":{\"id\":\"80b2519f-1ef4-47e6-8557-374c4b8ad0a6\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"0d8f2290-1aac-4a97-86cf-fbefd7e55247\",\"z\":20,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"139dcaf6-9584-47f2-8219-d71c1da608db\",\"port\":\"  \"},\"target\":{\"id\":\"139dcaf6-9584-47f2-8219-d71c1da608db\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"a973fefa-1d2a-4c5f-9d77-b1178784c8f3\",\"z\":22,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"fb18b790-e884-4308-b05f-e7d332128ca3\",\"port\":\"  \"},\"target\":{\"id\":\"71f2758e-a441-4a63-a6ce-a6d3ae94767e\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"fdf27188-3df3-407b-9e23-bc27bef6ad1f\",\"z\":26,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":675,\"y\":359},\"angle\":0,\"id\":\"ffb8cb43-2359-47b1-bf74-8ed195292804\",\"z\":29,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Delete Bucket Policy via Object\"},\".p_id\":{\"text\":\"60ec30a5acb7e500f63ea02f\"},\"image\":{\"xlink:href\":\"/plugins/Amazon-aws-s3/logo.png\",\"ref-y\":50},\"text\":{\"text\":\"Delete Bucket Policy via Object\"}}},{\"type\":\"link\",\"source\":{\"id\":\"23fd6698-db5a-4931-bc91-8cbb47609219\",\"port\":\"  \"},\"target\":{\"id\":\"ffb8cb43-2359-47b1-bf74-8ed195292804\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"c87c96af-d3d8-452a-875e-6a6dc6acc056\",\"z\":30,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":587,\"y\":521},\"angle\":0,\"id\":\"0ec3f7ec-9ad2-41a1-8b40-752950395db4\",\"z\":32,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Create the new JSON file\"},\".p_id\":{\"text\":\"60ec2fbeacb7e500f63e9fc2\"},\"image\":{\"xlink:href\":\"/plugins/TextEditor/TextEditor.png\",\"ref-y\":50},\"text\":{\"text\":\"Create the new JSON file\"}}},{\"type\":\"link\",\"source\":{\"id\":\"80b2519f-1ef4-47e6-8557-374c4b8ad0a6\",\"port\":\"  \"},\"target\":{\"id\":\"0ec3f7ec-9ad2-41a1-8b40-752950395db4\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"34334cd8-e453-4167-a198-a437615e342a\",\"z\":33,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":805,\"y\":518},\"angle\":0,\"id\":\"490ce396-3ec7-4dea-8d7f-88ff7590eb68\",\"z\":35,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Replace Bucket Policy via Object\"},\".p_id\":{\"text\":\"60ec30a5acb7e500f63ea02f\"},\"image\":{\"xlink:href\":\"/plugins/Amazon-aws-s3/logo.png\",\"ref-y\":50},\"text\":{\"text\":\"Replace Bucket Policy via Object\"}}},{\"type\":\"link\",\"source\":{\"id\":\"0ec3f7ec-9ad2-41a1-8b40-752950395db4\",\"port\":\"  \"},\"target\":{\"id\":\"490ce396-3ec7-4dea-8d7f-88ff7590eb68\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"ddad6703-44fd-43cb-977b-16e75cd5ac60\",\"z\":36,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":183,\"y\":283},\"angle\":0,\"id\":\"13d4847c-37be-493d-a8b5-9c91081bbd02\",\"z\":38,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Get report details\"},\".p_id\":{\"text\":\"60ec2ebeacb7e500f63e9f36\"},\"image\":{\"xlink:href\":\"/plugins/lacework/lacework.png\",\"ref-y\":50},\"text\":{\"text\":\"Get report details\"}}},{\"type\":\"link\",\"source\":{\"id\":\"6297d603-cd5f-4fca-b5f5-4d14847dcd94\",\"port\":\" \"},\"target\":{\"id\":\"13d4847c-37be-493d-a8b5-9c91081bbd02\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"c47653c5-405e-4e01-becc-d6f29fd494c0\",\"z\":39,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"13d4847c-37be-493d-a8b5-9c91081bbd02\",\"port\":\"  \"},\"target\":{\"id\":\"6bc1844a-4f56-46f4-b742-f9000115cf90\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"069052be-5a27-45ec-ba32-a77a75b68bb2\",\"z\":40,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"13d4847c-37be-493d-a8b5-9c91081bbd02\",\"port\":\"  \"},\"target\":{\"id\":\"c93f881a-3dcd-4c80-893a-91d63f16751f\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"3d86cf60-62ee-4d80-a088-45c3367996a4\",\"z\":41,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"13d4847c-37be-493d-a8b5-9c91081bbd02\",\"port\":\"  \"},\"target\":{\"id\":\"9f29c8df-ccbe-442f-a1e6-6e8b996d8916\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"9bcbc1e8-9fdb-44a5-9194-9198846dce42\",\"z\":42,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"edb32ef5-243a-4b7f-bac8-e764823911e2\",\"port\":\"  \"},\"target\":{\"id\":\"139dcaf6-9584-47f2-8219-d71c1da608db\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"29a19a44-7132-4aa5-992c-39c762140d97\",\"z\":43,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"13d4847c-37be-493d-a8b5-9c91081bbd02\",\"port\":\"  \"},\"target\":{\"id\":\"139dcaf6-9584-47f2-8219-d71c1da608db\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"548eac42-2161-413c-a1b8-d44629120fec\",\"z\":44,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"13d4847c-37be-493d-a8b5-9c91081bbd02\",\"port\":\"  \"},\"target\":{\"id\":\"23fd6698-db5a-4931-bc91-8cbb47609219\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"8ce80210-7d81-4e6b-ae1b-0217b87746d8\",\"z\":45,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"13d4847c-37be-493d-a8b5-9c91081bbd02\",\"port\":\"  \"},\"target\":{\"id\":\"80b2519f-1ef4-47e6-8557-374c4b8ad0a6\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"0be15b5b-de5a-44aa-96a4-a5873bb12bed\",\"z\":46,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":462,\"y\":158},\"angle\":0,\"id\":\"61b3c90d-a3fe-4e48-8286-e926b8e75011\",\"z\":47,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Put Bucket Tags via CLI\"},\".p_id\":{\"text\":\"60ec31a0acb7e500f63ea119\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\"text\":{\"text\":\"Put Bucket Tags via CLI\"}}},{\"type\":\"link\",\"source\":{\"id\":\"61b3c90d-a3fe-4e48-8286-e926b8e75011\",\"port\":\"  \"},\"target\":{\"id\":\"61b3c90d-a3fe-4e48-8286-e926b8e75011\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"442c7856-07a3-427a-9c82-05447f16b5a9\",\"z\":48,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":641,\"y\":160},\"angle\":0,\"id\":\"ad5fa8ff-e5d6-43ed-b7b0-142e9c6750be\",\"z\":49,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"PutBucket Tags via Object\"},\".p_id\":{\"text\":\"60ec30d1acb7e500f63ea0b6\"},\"image\":{\"xlink:href\":\"/plugins/AWS-resource-groups-tagging/logo.png\",\"ref-y\":50},\"text\":{\"text\":\"PutBucket Tags via Object\"}}},{\"type\":\"link\",\"source\":{\"id\":\"ad5fa8ff-e5d6-43ed-b7b0-142e9c6750be\",\"port\":\"  \"},\"target\":{\"id\":\"ad5fa8ff-e5d6-43ed-b7b0-142e9c6750be\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"18c2a902-ce58-4444-a82f-8fbe5326e05e\",\"z\":50,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"edb32ef5-243a-4b7f-bac8-e764823911e2\",\"port\":\"  \"},\"target\":{\"id\":\"61b3c90d-a3fe-4e48-8286-e926b8e75011\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"6e07f0d1-8d09-48e0-9bcf-dff389c017a0\",\"z\":51,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"13d4847c-37be-493d-a8b5-9c91081bbd02\",\"port\":\"  \"},\"target\":{\"id\":\"61b3c90d-a3fe-4e48-8286-e926b8e75011\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"653f7875-da7a-4983-9663-a257bb165e1a\",\"z\":52,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"edb32ef5-243a-4b7f-bac8-e764823911e2\",\"port\":\"  \"},\"target\":{\"id\":\"ad5fa8ff-e5d6-43ed-b7b0-142e9c6750be\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"b866047d-1b12-4428-8f30-f1ec1cbabb62\",\"z\":53,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"13d4847c-37be-493d-a8b5-9c91081bbd02\",\"port\":\"  \"},\"target\":{\"id\":\"ad5fa8ff-e5d6-43ed-b7b0-142e9c6750be\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"66dc8841-6ae2-4f92-8e73-4f06934cfb8a\",\"z\":54,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":334,\"y\":661},\"angle\":0,\"id\":\"bb7e8bad-455d-4b23-9371-0ad9284fe2ea\",\"z\":55,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Get current suppression configuration\"},\".p_id\":{\"text\":\"60ec2ebeacb7e500f63e9f36\"},\"image\":{\"xlink:href\":\"/plugins/lacework/lacework.png\",\"ref-y\":50},\"text\":{\"text\":\"Get current suppression configuration\"}}},{\"type\":\"link\",\"source\":{\"id\":\"edb32ef5-243a-4b7f-bac8-e764823911e2\",\"port\":\"  \"},\"target\":{\"id\":\"bb7e8bad-455d-4b23-9371-0ad9284fe2ea\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"7598026d-43df-4a0f-becd-fb1ebd630885\",\"z\":56,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"13d4847c-37be-493d-a8b5-9c91081bbd02\",\"port\":\"  \"},\"target\":{\"id\":\"bb7e8bad-455d-4b23-9371-0ad9284fe2ea\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"a880dd52-b890-49a3-9bf6-481bba51fc0c\",\"z\":57,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":603,\"y\":661},\"angle\":0,\"id\":\"35605515-c1b7-4a85-a12c-7de0e4a7a283\",\"z\":58,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Configure Suppression via Tags\"},\".p_id\":{\"text\":\"60ec2ebeacb7e500f63e9f36\"},\"image\":{\"xlink:href\":\"/plugins/lacework/lacework.png\",\"ref-y\":50},\"text\":{\"text\":\"Configure Suppression via Tags\"}}},{\"type\":\"link\",\"source\":{\"id\":\"bb7e8bad-455d-4b23-9371-0ad9284fe2ea\",\"port\":\"  \"},\"target\":{\"id\":\"35605515-c1b7-4a85-a12c-7de0e4a7a283\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"77d1f473-f4d5-4575-b99b-1e3ce3d6fe1c\",\"z\":59,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":531,\"y\":-181},\"angle\":0,\"id\":\"7820e1ca-feef-4bcf-86ed-22e5e1d43ded\",\"z\":60,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Create Backup via CLI\"},\".p_id\":{\"text\":\"60ec31a0acb7e500f63ea119\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\".inPorts circle\":{\"fill\":\"#c8c8c8\"},\".outPorts circle\":{\"fill\":\"#262626\"},\"text\":{\"text\":\"Create Backup via CLI\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":763,\"y\":-188},\"angle\":0,\"id\":\"346e3cec-5ff5-4015-a2a0-804160e9c616\",\"z\":61,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Delete Bucket Policy via CLI\"},\".p_id\":{\"text\":\"60ec31a0acb7e500f63ea119\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\".inPorts circle\":{\"fill\":\"#c8c8c8\"},\".outPorts circle\":{\"fill\":\"#262626\"},\"text\":{\"text\":\"Delete Bucket Policy via CLI\"}}},{\"type\":\"link\",\"source\":{\"id\":\"6bc1844a-4f56-46f4-b742-f9000115cf90\",\"port\":\"  \"},\"target\":{\"id\":\"7820e1ca-feef-4bcf-86ed-22e5e1d43ded\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"09ba81cc-a2a9-4e95-859f-796c9ba6405f\",\"z\":62,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"7820e1ca-feef-4bcf-86ed-22e5e1d43ded\",\"port\":\"  \"},\"target\":{\"id\":\"346e3cec-5ff5-4015-a2a0-804160e9c616\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"36c41454-cd15-4268-a969-6968c8f1a9bd\",\"z\":63,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"346e3cec-5ff5-4015-a2a0-804160e9c616\",\"port\":\"  \"},\"target\":{\"id\":\"6bc1844a-4f56-46f4-b742-f9000115cf90\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"3ee45887-774e-4f3b-9ca3-221419f89c9d\",\"z\":64,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"71f2758e-a441-4a63-a6ce-a6d3ae94767e\",\"port\":\"  \"},\"target\":{\"id\":\"c93f881a-3dcd-4c80-893a-91d63f16751f\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"3ab6dcf5-4345-47ae-8e95-4e3bb9d3f545\",\"z\":65,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"devs.MyImageModel\",\"size\":{\"width\":100,\"height\":73},\"inPorts\":[\" \"],\"outPorts\":[\"  \"],\"ports\":{\"groups\":{\"in\":{\"position\":{\"name\":\"left\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"left\",\"args\":{\"y\":10}}}},\"out\":{\"position\":{\"name\":\"right\"},\"attrs\":{\".port-label\":{\"fill\":\"#000\"},\".port-body\":{\"fill\":\"#fff\",\"stroke\":\"#000\",\"r\":10,\"magnet\":true}},\"label\":{\"position\":{\"name\":\"right\",\"args\":{\"y\":10}}}}},\"items\":[{\"id\":\" \",\"group\":\"in\",\"attrs\":{\".port-label\":{\"text\":\" \"}}},{\"id\":\"  \",\"group\":\"out\",\"attrs\":{\".port-label\":{\"text\":\"  \"}}}]},\"position\":{\"x\":558,\"y\":-56},\"angle\":0,\"id\":\"50a74597-948a-4c52-a037-6fbc176ac4b1\",\"z\":66,\"attrs\":{\"rect\":{\"stroke-width\":1,\"fill\":\"#2d3236\"},\".label\":{\"text\":\"Create Backup via CLI\"},\".p_id\":{\"text\":\"60ec31a0acb7e500f63ea119\"},\"image\":{\"xlink:href\":\"/plugins/CommandLine/CommandLine.png\",\"ref-y\":50},\".inPorts circle\":{\"fill\":\"#c8c8c8\"},\".outPorts circle\":{\"fill\":\"#262626\"},\"text\":{\"text\":\"Create Backup via CLI\"}}},{\"type\":\"link\",\"source\":{\"id\":\"c93f881a-3dcd-4c80-893a-91d63f16751f\",\"port\":\"  \"},\"target\":{\"id\":\"50a74597-948a-4c52-a037-6fbc176ac4b1\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"544db2c8-d861-42c5-a038-f4f42472b1c2\",\"z\":67,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"50a74597-948a-4c52-a037-6fbc176ac4b1\",\"port\":\"  \"},\"target\":{\"id\":\"fb18b790-e884-4308-b05f-e7d332128ca3\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"3d9dec53-2b8d-434a-9b8d-8ad0bff3e0dc\",\"z\":68,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"ffb8cb43-2359-47b1-bf74-8ed195292804\",\"port\":\"  \"},\"target\":{\"id\":\"23fd6698-db5a-4931-bc91-8cbb47609219\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"2cb5d5a3-bdde-404f-be12-94bd38f86c95\",\"z\":69,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}},{\"type\":\"link\",\"source\":{\"id\":\"490ce396-3ec7-4dea-8d7f-88ff7590eb68\",\"port\":\"  \"},\"target\":{\"id\":\"80b2519f-1ef4-47e6-8557-374c4b8ad0a6\",\"port\":\" \"},\"router\":{\"name\":\"manhattan\"},\"connector\":{\"name\":\"rounded\"},\"id\":\"7c8e9a0e-0883-446f-9682-f5fdf25482c7\",\"z\":70,\"attrs\":{\".connection\":{\"stroke\":\"#87939A\",\"stroke-width\":3},\".marker-target\":{\"fill\":\"#87939A\",\"d\":\"M 10 0 L 0 5 L 10 10 z\"}}}]}",
    "used_plugins": [
        {
            "name": "lacework",
            "version": "1.0.0"
        },
        {
            "name": "CommandLine",
            "version": "1.2.0"
        },
        {
            "name": "Slack",
            "version": "1.1.0"
        },
        {
            "name": "CommandLine",
            "version": "1.2.0"
        },
        {
            "name": "CommandLine",
            "version": "1.2.0"
        },
        {
            "name": "Amazon-aws-s3",
            "version": "1.4.0"
        },
        {
            "name": "Amazon-aws-s3",
            "version": "1.4.0"
        },
        {
            "name": "Slack",
            "version": "1.1.0"
        },
        {
            "name": "TextEditor",
            "version": "1.0.0"
        },
        {
            "name": "Amazon-aws-s3",
            "version": "1.5.4"
        },
        {
            "name": "TextEditor",
            "version": "1.0.0"
        },
        {
            "name": "Amazon-aws-s3",
            "version": "1.5.4"
        },
        {
            "name": "lacework",
            "version": "1.2.0"
        },
        {
            "name": "CommandLine",
            "version": "1.2.0"
        },
        {
            "name": "AWS-resource-groups-tagging",
            "version": "1.1.0"
        },
        {
            "name": "lacework",
            "version": "1.2.3"
        },
        {
            "name": "lacework",
            "version": "1.2.3"
        }
    ],
    "__v": 0,
    "code": "// Default variables for this Map\nvar bucketArr = []; // Array of S3 Buckets that will be filled with the resource information from the event.\nvar indexRemediate = 0; // Index for the S3 Bucket Remediate of the Map\nvar indexSlack = 0; // Index of the Slack Loop to send out information about the S3 Bucket remediation.\nvar bucketIgnoredArr = []; // Array of S3 Buckets that are violating but will be ignored.\nvar indexIgnored = 0; //Index of the S3 Buckets that are violating but will be ignored.\nvar indexTag = 0; // Index for setting tags for the ignored S3 buckets so they will be suppressed after the next compliance check.\nlet payload = trigger.payload; // The Payload that was send by the Webhook Trigger. Information about the Payload is available at https://support.lacework.com/hc/en-us/articles/360034367393-Webhook\nvar link; // Link used for Slack messages to send out about the event and report.\nvar event_aws_accountid; // AWS Account ID for the Event or the Report against it will run the CLI commands or Objects. Will be read out from the Event itself.\nvar event_aws_account_key; // AWS Account Key variable to get the value from the vault.\nvar event_aws_secret_key; // AWS Secret Key variable to get the value from the vault.\nvar suppressionTag; //Variable with the current Tag Name\nvar suppressionValue; //Variables with the current Tag Value\n\n// Object \"Get event details\" functions:\nfunction checkconfigurationforevent()  { // Function to check if two out of four Auto Remediation steps are enabled.\n    if (configuration.dothedeletebucketpolicyremediationviacli == \"true\" && configuration.dothereplacebucketpolicyremediationviacli == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothedeletebucketpolicyremediationviacli == \"true\" && configuration.dothedeletebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothedeletebucketpolicyremediationviacli == \"true\" && configuration.dothereplacebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothereplacebucketpolicyremediationviacli == \"true\" && configuration.dothedeletebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothereplacebucketpolicyremediationviacli == \"true\" && configuration.dothereplacebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothereplacebucketpolicyremediationviaobject == \"true\" && configuration.dothedeletebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (payload !== null) // Don't try to get the Events if the payload is not defined.\n    {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction createBucketList() { // Function to build the S3 Bucket List that will be used for Auto Remediation.\n    let p = configuration.eventuuid;\n    let laceworkAPIResult = getAction(p);\n    link = payload.event_link;\n    if (laceworkAPIResult.result.result.data[0].ENTITY_MAP.ViolationReason[0].REC_ID == configuration.rec_id) {\n        event_aws_accountid = laceworkAPIResult.result.result.data[0].ENTITY_MAP.RecId[0].ACCOUNT_ID;\n        event_aws_account_key = event_aws_accountid;\n        event_aws_account_key += \"_aws_access_key_id\";\n        event_aws_secret_key = event_aws_accountid;\n        event_aws_secret_key += \"_aws_secret_access_key\";\n        if (configuration.autoremediationonlyfornewviolations == \"true\")\n        {\n            let resourcesArr = laceworkAPIResult.result.result.data[0].ENTITY_MAP.NewViolation;\n            for (let i = 0; i < resourcesArr.length; i++) {\n            if (!configuration.bucketIgnoreList.includes(resourcesArr[i].RESOURCE)) { // The S3 Bucket of the Event will be checked against the configuration list of to ignore S3 buckets.\n                bucketArr.push(resourcesArr[i].RESOURCE); // If the bucket is not on the list it will be pushed into the array.\n            }\n            else {\n                bucketIgnoredArr.push(resourcesArr[i].RESOURCE); // If the bucket is on the list and violating the policy it will be pushed into the second bucket list.\n            }\n        }\n        }\n        else\n        {\n            let resourcesArr = laceworkAPIResult.result.result.data[0].ENTITY_MAP.Resource;\n            for (let i = 0; i < resourcesArr.length; i++) {\n            if (!configuration.bucketIgnoreList.includes(resourcesArr[i].VALUE)) { // The S3 Bucket of the Event will be checked against the configuration list of to ignore S3 buckets.\n                bucketArr.push(resourcesArr[i].VALUE); // If the bucket is not on the list it will be pushed into the array.\n            }\n            else {\n                bucketIgnoredArr.push(resourcesArr[i].VALUE); // If the bucket is on the list and violating the policy it will be pushed into the second bucket list.\n            }\n        }\n        }\n    }\n}\n\nfunction geteventid() { // Function to get the Event ID from the Webhook Payload.\n    return `${payload.event_id}`;\n}\n\n// Object \"Get report details\" functions:\nfunction checkconfigurationforreport() { // Function to check if CLI and Object Auto Remediation is enabled. Also check if it is not triggered via a Webhook with a payload send.\n    if (configuration.dothedeletebucketpolicyremediationviacli == \"true\" && configuration.dothereplacebucketpolicyremediationviacli == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothedeletebucketpolicyremediationviacli == \"true\" && configuration.dothedeletebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothedeletebucketpolicyremediationviacli == \"true\" && configuration.dothereplacebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothereplacebucketpolicyremediationviacli == \"true\" && configuration.dothedeletebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothereplacebucketpolicyremediationviacli == \"true\" && configuration.dothereplacebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (configuration.dothereplacebucketpolicyremediationviaobject == \"true\" && configuration.dothedeletebucketpolicyremediationviaobject == \"true\") {\n        return 0;\n    }\n    else if (payload == null) // Only trigger the Report collection if there is no payload defined.\n    {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction createBucketListfromReport() { // Function to build the S3 Bucket List that will be used to Remediate.\n    let p = configuration.reportuuid;\n    let laceworkAPIResult = getAction(p);\n    let findreason = 0;\n    let recommendationsArr = laceworkAPIResult.result.result.data[0].recommendations;\n    for (let i = 0; i < recommendationsArr.length; i++) {\n        if (recommendationsArr[i].REC_ID == configuration.rec_id) {\n            link = recommendationsArr[i].INFO_LINK;\n            findreason = i;\n        }\n        else {\n            // Didn't found the right reason\n        }\n    }\n    let resourcesArr = laceworkAPIResult.result.result.data[0].recommendations[findreason].VIOLATIONS;\n    event_aws_accountid = configuration.awsaccountid;\n    event_aws_account_key = event_aws_accountid;\n    event_aws_account_key += \"_aws_access_key_id\";\n    event_aws_secret_key = event_aws_accountid;\n    event_aws_secret_key += \"_aws_secret_access_key\";\n    for (let i = 0; i < resourcesArr.length; i++) {\n        if (!configuration.bucketIgnoreList.includes(resourcesArr[i].resource)) { // The S3 Bucket of the Event will be checked against the configuration list of to ignore S3 buckets.\n            bucketArr.push(resourcesArr[i].resource); // If the bucket is not on the list it will be pushed into the array.\n        }\n        else {\n            bucketIgnoredArr.push(resourcesArr[i].resource); // If the bucket is on the list and violating the policy it will be pushed into the second bucket list.\n        }\n    }\n}\n\nfunction getawsaccountid() {\n    return `${configuration.awsaccountid}`;\n}\n\nfunction getreporttype() {\n    return `${configuration.reporttype}`;\n}\n\n\n// Object \"Print Bucket policy\"\nfunction checkdeleteremediationviacli() //Check if the Delete Remedation should be done via the CLI?\n{\n    if (configuration.dothedeletebucketpolicyremediationviacli == \"true\") {\n        if (indexRemediate < bucketArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction printBucketName() { // Function to print the S3 buckets that will be remediated.\n    let bucket = bucketArr[indexRemediate]\n    let arr = bucket.split(\":::\")\n    return `echo Compliance Violation ${configuration.rec_id} for the S3 bucket ${arr[arr.length-1]}`;\n}\n\n// Object \"Create Backup\"\nfunction createbackup() { // Function to backup the S3 bucket policy before it is replaced.\n    if (configuration.createbackup == \"true\") {\n        let bucket = bucketArr[indexRemediate]\n        let arr = bucket.split(\":::\")\n        let currentdate = Date.now();\n        return `aws s3api get-bucket-policy --bucket ${arr[arr.length-1]} > ${configuration.backupfolder}${arr[arr.length-1]}-${currentdate}-${configuration.rec_id}.json --profile ${event_aws_accountid}`; \n    }\n    else {\n        return `Creating backup inside the configuration is disabled. Skipping.`\n    }\n}\n\n// Object \"Delete Bucket Policy\"\nfunction deleteviaawscli() { // Delete the Bucket Policy via CLI\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    return `aws s3api delete-bucket-policy --bucket ${arr[arr.length-1]} --profile ${event_aws_accountid}`; // Using the delete-bucket-policy method. Feel free to replace it with whatever you think is the right aws cli command to trigger.\n}\n\n// Object \"Create Backup via CLI\" \nfunction checkreplaceremediationviacli() //Check if the Replace Remedation should be done via the CLI?\n{\n    if (configuration.dothereplacebucketpolicyremediationviacli == \"true\") {\n        if (indexRemediate < bucketArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\n\n// Object \"Create the new JSON file\"\n\nfunction getfilepath() { //Getting the filepath and name for the file that will be created.\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    return `${configuration.inputfolder}${arr[arr.length-1]}-${configuration.rec_id}.json`;\n}\n\nfunction getfilecontent() { //Getting the file content of what will be written into the file itself.\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    configuration.bucketpolicy.Statement[0].Resource = bucket;\n    const myjson = JSON.stringify(configuration.bucketpolicy);\n    return `${myjson}`;\n}\n\n// Object \"Replace Bucket Policy via CLI\"\nfunction replacebucketpolicyviacli() { // Replace the Bucket Policy via CLI\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    configuration.bucketpolicy.Statement[0].Resource = bucket;\n    let myoutput = JSON.stringify(configuration.bucketpolicy);\n    return `aws s3api put-bucket-policy --bucket ${arr[arr.length-1]} --policy file://${configuration.inputfolder}${arr[arr.length-1]}-${configuration.rec_id}.json --profile ${event_aws_accountid}`; //Using the setting --acl private. Feel free to replace it with whatever you think is the right aws cli command to trigger.\n}\n\n// Object \"Put Bucket Tags via CLI\"\nfunction checkputbuckettagsviacli() { //Check if AWS Tags should be added to the S3 bucket.\n   if (configuration.putbuckettaggingviacli == \"true\") {\n        if (indexTag < bucketIgnoredArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction putbuckettagging(){ // Put the S3 Bucket tags for suppression.\n    let bucket = bucketIgnoredArr[indexTag];\n    return `aws resourcegroupstaggingapi tag-resources --resource-arn-list ${bucketIgnoredArr[indexTag]} --tags ${configuration.tagname}=${configuration.tagvalue} --profile ${event_aws_accountid}` ; //Using the put-bucket-tagging to create the tags of the S3 buckets\n}\n\n\n// Object \"PutBucket Tags via Object\"\nfunction checkputbuckettagsviaobject() { // Check if AWS Tags should be added to the S3 bucket.\n   if (configuration.putbuckettaggingviaobject == \"true\") {\n        if (indexTag < bucketIgnoredArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction getawsaccesskeyfromvaultfortag() { // Get the right AWS Access Key from the Vault\n    let aws_access_key = useKey(event_aws_account_key);\n    return aws_access_key; \n}\n\nfunction getawssecretkeyfromvaultfortag() { // Get the right AWS Secret Key from the Vault\n    let aws_secret_key = useKey(event_aws_secret_key);\n    return aws_secret_key; \n}\n\nfunction getbucketnameforobject() { // Get the S3 Bucket Name for the Tag Resource Object.\n    let bucket = bucketIgnoredArr[indexTag];\n    return `${bucket}`; \n}\n\nfunction getbuckettagsforobject() { // Get the tag and tag value that will be put on the S3 bucket.\n    return `${configuration.tagname}=${configuration.tagvalue}`;\n}\n \n// Object \"Remediated\"\nfunction checkforslack() { //Check if you want to also see the resources via the slack messages.\n    if (indexSlack < bucketArr.length && configuration.sendslackmessagesforremediation == \"true\") {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction sendslackmessage() { // Function to send out a slack message for every S3 bucket that will be remediated.\n    let bucket = bucketArr[indexSlack];\n    let arr = bucket.split(\":::\");\n    if (configuration.dothedeletebucketpolicyremediationviacli == \"true\") {\n        return `Compliance Violation ${configuration.rec_id} The following S3 bucket is auto remediated back to ${configuration.violationdescription}: ${arr[arr.length-1]}. Executing CLI command aws s3api delete-bucket-policy --bucket ${arr[arr.length-1]}. More information about the event is available at ${link}`;\n    }\n    else if (configuration.dothereplacebucketpolicyremediationviacli == \"true\") {\n        return `Compliance Violation ${configuration.rec_id} The following S3 bucket is auto remediated back to ${configuration.violationdescription}: ${arr[arr.length-1]}. Executing CLI command aws s3api put-bucket-policy --bucket ${arr[arr.length-1]} --policy file://${configuration.inputfolder}${arr[arr.length-1]}.json. More information about the event is available at ${link}`;\n    }\n    else if (configuration.dothedeletebucketpolicyremediationviaobject == \"true\") {\n        return `Compliance Violation ${configuration.rec_id} The following S3 bucket is auto remediated back to ${configuration.violationdescription}: ${arr[arr.length-1]}. Using the Kaholo S3 object to do the delete of the bucket policy remediation. More information about the event is available at ${link}`;\n    }\n    else if (configuration.dothereplacebucketpolicyremediationviaobject == \"true\") {\n        return `Compliance Violation ${configuration.rec_id} The following S3 bucket is auto remediated back to ${configuration.violationdescription}: ${arr[arr.length-1]}. Using the Kaholo S3 object to do the replace of the bucket policy remediation. More information about the event is available at ${link}`;\n    }\n    else {\n        return `Compliance Violation ${configuration.rec_id}. Auto Remediation is diabled! The following S3 bucket would be auto remediated ${configuration.violationdescription}: ${arr[arr.length-1]}. More information about the event is available at ${link}`;   \n    }\n}\n\n// Object \"Ignored\"\nfunction checkforignoredslack() { //Check if you want to also see the ignored buckets via the slack messages.\n    if (indexIgnored < bucketIgnoredArr.length && configuration.sendslackmessagesforignored == \"true\") {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction sendslackmessageforignored() { // Function to send out a slack message for every S3 bucket that will be ignored but is violating the policy.\n    let bucket = bucketIgnoredArr[indexIgnored];\n    let arr = bucket.split(\":::\");\n    return `Compliance Violation ${configuration.rec_id} The following S3 bucket is NOT remediated back to ${configuration.violationdescription}: ${arr[arr.length-1]}. It is ignored by the configuration of the Map. We recommend using tags in AWS to suppress this S3 bucket from triggering alerts in Lacework. More information about the event is available at ${link}`;    \n}\n\n\n// Object \"Backup Bucket Policy via Object\"\nfunction checkdeleteremediationviaobject() //Check if the Delete Remedation should be done via the Object?\n{\n    if (configuration.dothedeletebucketpolicyremediationviaobject == \"true\") {\n        if (indexRemediate < bucketArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction getbucketname() { // Function to print the S3 buckets that will be remediated.\n    let bucket = bucketArr[indexRemediate]\n    let arr = bucket.split(\":::\")\n    return `${arr[arr.length-1]}`;\n}\n\nfunction getawsaccesskeyfromvaultforremediation() { // Get the right AWS Access Key from the Vault\n    let aws_access_key = useKey(event_aws_account_key);\n    return aws_access_key; \n}\n\nfunction getawssecretkeyfromvaultforremediation() { // Get the right AWS Secret Key from the Vault\n    let aws_secret_key = useKey(event_aws_secret_key);\n    return aws_secret_key; \n}\n\n\n// Object \"Delete Bucket Policy via Object\"\n\nfunction getbucketnameforremediation() {\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\")\n    return `${arr[arr.length-1]}`;\n}\n\n\n// Object \"Backup Bucket Policy via Object\"\nfunction checkreplaceremediationviaobject() //Check if the Replace Remedation should be done via the Object?\n{\n    if (configuration.dothereplacebucketpolicyremediationviaobject == \"true\") {\n        if (indexRemediate < bucketArr.length) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    else {\n        return 0;\n    }\n}\n\n// Object \"Create the new JSON file\"\n\n// Object \"Replace Bucket Policy via Object\"\nfunction remediateviaobject() { // Remediate the S3 buckets back to private acl.\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    return `${arr[arr.length-1]}`; //Using the canned acl private.\n}\n\nfunction createnewpolicyjson() { // Optional (Not in use): A way how you can create the JSON file on the command line.\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    configuration.bucketpolicy.Statement[0].Resource = bucket;\n    const myjson = JSON.stringify(configuration.bucketpolicy)\n    //let myoutput = myjson.replace(/\"/g, '\\\"');\n    return `${myjson}`;\n}\n\n// Object \"Get current suppression configuration\" functions:\nfunction checksuppressionconfiguration() {\n    if (configuration.configuresuppressiononpolicy == \"true\") {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nfunction getrecommendationID() {\n    return `${configuration.rec_id}`;\n}\n\nfunction createcurrentsuppressionsetting() { //Function to put the current settings of a suppression configuration.\n    let q = configuration.suppressionuuid;\n    let laceworkAPIResult = getAction(q);\n    let suppressionConditions = `laceworkAPIResult.result.result.data[0].${configuration.rec_id}.suppressionConditions`;\n   // let suppressionConditions = laceworkAPIResult.result.result.data[0].LW_S3_17.suppressionConditions;\n    suppressionTag = \"NotConfigured\";\n    for (let i = 0; i < suppressionConditions.length; i++) {\n        let suppressionResourceTags = laceworkAPIResult.result.result.data[0].LW_S3_17.suppressionConditions[i].resourceTags;\n        for (let j = 0; j < suppressionResourceTags.length; j++) {\n            if (suppressionResourceTags[j].key == configuration.tagname)\n            {\n                suppressionTag = \"Configured\";\n                suppressionValue = suppressionResourceTags[j].value;\n            }\n        }\n    }\n}\n\n// Object \"Configure Suppression via Tags\" functions:\nfunction checksuppressionneedstobeconfigured() {\n    if (suppressionTag == \"Configured\") {\n        if (suppressionValue == configuration.tagvalue)\n        {\n            // Nothing to configure, tagkey and tagvalue are configured correctly.\n            return 0;\n        }\n        else \n        {\n            // Suppression Tag is correct, however the value is configured wrong.\n            return 1;\n        }\n    }\n    else {\n        // Suppression Tag is not configured.\n        return 1;\n    }\n}\n\nfunction getrecommendationIDforSuppression() {\n    return `${configuration.rec_id}`;\n}\n\nfunction getTagKeyforSuppression() {\n    return `${configuration.tagname}`;\n}\n\nfunction getTagValueforSuppression() {\n    return `${configuration.tagvalue}`;\n}\n\nfunction getsuppressionpolicycommentforSuppression() {\n    return `${configuration.suppressionpolicycomment}`;\n}\n\n// Help Functions for all Objects.\nfunction getAction(pId) {  // Help function to get the return value of the event.\n   let p = getProcessById(pId)//Get the process. \n   if(!p ||!p.length)return; \n   p = p[p.length-1].actions; //Get all actions \n   let action = p[Object.keys(p)[0]];//get the needed action \n   return action \n}\n\nfunction getvault() {\n    return `echo ${vault.test}`;\n}\n\nasync function useKey(key){\n  return vault.getValueByKey(key)\n}\n\n//left over (not in used functions)\n\nfunction createnewpolicyfile() { // Optional (Not in use): A way how you can create the JSON file on the command line.\n    let bucket = bucketArr[indexRemediate];\n    let arr = bucket.split(\":::\");\n    configuration.bucketpolicy.Statement[0].Resource = bucket;\n    const myjson = JSON.stringify(configuration.bucketpolicy)\n    let myoutput = myjson.replace(/\"/g, '\\\"');\n    return `echo \"${myoutput}\" > ${configuration.inputfolder}${arr[arr.length-1]}-${configuration.rec_id}.json`;\n}\n\nfunction testprint () { // Test Print, not in use so far.\n   configuration.bucketpolicy.Statement[0].Resource = \"adflkasdflkjasdf\"\n   let myoutput = JSON.stringify(configuration.bucketpolicy);\n   return `echo ${myoutput}`;\n}"
}